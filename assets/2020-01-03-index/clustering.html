<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Unit 7 Clustering | Analytics Edge - EdX</title>
  <meta name="description" content="EdX Analytics Edge, Notes and Assignments" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Unit 7 Clustering | Analytics Edge - EdX" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="EdX Analytics Edge, Notes and Assignments" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Unit 7 Clustering | Analytics Edge - EdX" />
  
  <meta name="twitter:description" content="EdX Analytics Edge, Notes and Assignments" />
  

<meta name="author" content="omotoyosi Taiwo" />


<meta name="date" content="2019-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="text-analytics.html"/>
<link rel="next" href="visualization.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Analytics Edge - EdX</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> EdX Analytics Edge Notebook</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#working-with-data"><i class="fa fa-check"></i><b>2.1</b> Working with data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#loading-data-files"><i class="fa fa-check"></i><b>2.1.1</b> Loading data files</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#summary-statistics"><i class="fa fa-check"></i><b>2.1.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction.html"><a href="introduction.html#plots"><i class="fa fa-check"></i><b>2.1.3</b> Plots</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction.html"><a href="introduction.html#summary-tables"><i class="fa fa-check"></i><b>2.1.4</b> Summary tables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#recitation---usda-food-database"><i class="fa fa-check"></i><b>2.2</b> Recitation - USDA Food Database</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#data-analysis---recitation"><i class="fa fa-check"></i><b>2.2.1</b> Data Analysis - Recitation</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#histogram---recitation"><i class="fa fa-check"></i><b>2.2.2</b> Histogram - Recitation</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction.html"><a href="introduction.html#summary-tables---recitation"><i class="fa fa-check"></i><b>2.2.3</b> Summary tables - Recitation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#assignment"><i class="fa fa-check"></i><b>2.3</b> Assignment</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#part-1---analytical-detective"><i class="fa fa-check"></i><b>2.3.1</b> Part 1 - Analytical Detective</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#part-2---stock-dynamics"><i class="fa fa-check"></i><b>2.3.2</b> Part 2 - Stock Dynamics</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction.html"><a href="introduction.html#part-3---demographics-and-employment-in-the-united-states"><i class="fa fa-check"></i><b>2.3.3</b> Part 3 - Demographics and Employment in the United States</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-to-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Introduction to Linear Regression</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#variable-linear-regression-model---predicting-wine-quality"><i class="fa fa-check"></i><b>3.1.1</b> 1 variable Linear Regression Model - Predicting Wine Quality</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression-model"><i class="fa fa-check"></i><b>3.1.2</b> Multiple Linear Regression Model</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#correlation-and-muticollinearity"><i class="fa fa-check"></i><b>3.1.3</b> Correlation and Muticollinearity</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-regression.html"><a href="linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>3.1.4</b> Making Predictions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#recitation-2---moneyball-in-the-nba"><i class="fa fa-check"></i><b>3.2</b> Recitation 2 - MOneyball in the NBA</a><ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#regression-model-using-more-than-just-wins-variable"><i class="fa fa-check"></i><b>3.2.1</b> Regression model using more than just Wins variable</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>3.2.2</b> Making Predictions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#assignment-1"><i class="fa fa-check"></i><b>3.3</b> Assignment</a><ul>
<li class="chapter" data-level="3.3.1" data-path="linear-regression.html"><a href="linear-regression.html#part-1---climate-change"><i class="fa fa-check"></i><b>3.3.1</b> Part 1 - Climate Change</a></li>
<li class="chapter" data-level="3.3.2" data-path="linear-regression.html"><a href="linear-regression.html#part-2---detecting-flu-epidemics"><i class="fa fa-check"></i><b>3.3.2</b> Part 2 - Detecting Flu Epidemics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>4</b> Logistic Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-to-logistic-regression"><i class="fa fa-check"></i><b>4.1</b> Introduction to Logistic Regression</a><ul>
<li class="chapter" data-level="4.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#thresholding"><i class="fa fa-check"></i><b>4.1.1</b> Thresholding</a></li>
<li class="chapter" data-level="4.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>4.1.2</b> ROC Curves</a></li>
<li class="chapter" data-level="4.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#making-predictions-2"><i class="fa fa-check"></i><b>4.1.3</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#framingham-heart-study"><i class="fa fa-check"></i><b>4.2</b> Framingham Heart study</a></li>
<li class="chapter" data-level="4.3" data-path="logistic-regression.html"><a href="logistic-regression.html#recitation-3---election-forecasting"><i class="fa fa-check"></i><b>4.3</b> Recitation 3 - Election Forecasting</a><ul>
<li class="chapter" data-level="4.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#a-sophisticated-baseline-model"><i class="fa fa-check"></i><b>4.3.1</b> A sophisticated baseline model</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="logistic-regression.html"><a href="logistic-regression.html#assignment-2"><i class="fa fa-check"></i><b>4.4</b> Assignment</a><ul>
<li class="chapter" data-level="4.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#part-1---popularity-of-music-records"><i class="fa fa-check"></i><b>4.4.1</b> Part 1 - Popularity of Music Records</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html"><i class="fa fa-check"></i><b>5</b> Classification and Regression Trees (CART)</a><ul>
<li class="chapter" data-level="5.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#introduction-to-trees---judge-jury-and-classifier"><i class="fa fa-check"></i><b>5.1</b> Introduction to trees - Judge, Jury, and Classifier</a><ul>
<li class="chapter" data-level="5.1.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#random-forests"><i class="fa fa-check"></i><b>5.1.1</b> Random Forests</a></li>
<li class="chapter" data-level="5.1.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#cross-validation"><i class="fa fa-check"></i><b>5.1.2</b> Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#the-d2hawkeye-story"><i class="fa fa-check"></i><b>5.2</b> The D2Hawkeye Story</a><ul>
<li class="chapter" data-level="5.2.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#baseline-method-and-penalty-matrix"><i class="fa fa-check"></i><b>5.2.1</b> Baseline method and Penalty Matrix</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#recitation---boston-housing-data-regression-trees"><i class="fa fa-check"></i><b>5.3</b> Recitation - Boston Housing Data (Regression Trees)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#geographical-predictions"><i class="fa fa-check"></i><b>5.3.1</b> Geographical Predictions</a></li>
<li class="chapter" data-level="5.3.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#cross-validation-1"><i class="fa fa-check"></i><b>5.3.2</b> Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#assignment-3"><i class="fa fa-check"></i><b>5.4</b> Assignment</a><ul>
<li class="chapter" data-level="5.4.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#part-1---understanding-why-people-vote"><i class="fa fa-check"></i><b>5.4.1</b> Part 1 - Understanding why people vote</a></li>
<li class="chapter" data-level="5.4.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#part-2---letter-recognition"><i class="fa fa-check"></i><b>5.4.2</b> Part 2 - Letter Recognition</a></li>
<li class="chapter" data-level="5.4.3" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#part-3---predicting-earnings-from-census-data"><i class="fa fa-check"></i><b>5.4.3</b> Part 3 - Predicting Earnings from Census Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="text-analytics.html"><a href="text-analytics.html"><i class="fa fa-check"></i><b>6</b> Text Analytics</a><ul>
<li class="chapter" data-level="6.1" data-path="text-analytics.html"><a href="text-analytics.html#introduction-to-text-analytics"><i class="fa fa-check"></i><b>6.1</b> Introduction to Text Analytics</a><ul>
<li class="chapter" data-level="6.1.1" data-path="text-analytics.html"><a href="text-analytics.html#turning-tweets-into-knowledge"><i class="fa fa-check"></i><b>6.1.1</b> Turning Tweets into knowledge</a></li>
<li class="chapter" data-level="6.1.2" data-path="text-analytics.html"><a href="text-analytics.html#preprocessing-data"><i class="fa fa-check"></i><b>6.1.2</b> Preprocessing data</a></li>
<li class="chapter" data-level="6.1.3" data-path="text-analytics.html"><a href="text-analytics.html#build-a-cart-model"><i class="fa fa-check"></i><b>6.1.3</b> Build a CART model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="text-analytics.html"><a href="text-analytics.html#recitation---the-story-of-enron"><i class="fa fa-check"></i><b>6.2</b> Recitation - The Story of Enron</a><ul>
<li class="chapter" data-level="6.2.1" data-path="text-analytics.html"><a href="text-analytics.html#bag-of-words"><i class="fa fa-check"></i><b>6.2.1</b> Bag of Words</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="text-analytics.html"><a href="text-analytics.html#assignment-4"><i class="fa fa-check"></i><b>6.3</b> Assignment</a><ul>
<li class="chapter" data-level="6.3.1" data-path="text-analytics.html"><a href="text-analytics.html#part-1---detecting-vandalism-on-wikipedia"><i class="fa fa-check"></i><b>6.3.1</b> Part 1 - Detecting Vandalism on Wikipedia</a></li>
<li class="chapter" data-level="6.3.2" data-path="text-analytics.html"><a href="text-analytics.html#part-2---automating-reviews-in-medicine"><i class="fa fa-check"></i><b>6.3.2</b> Part 2 - Automating Reviews in Medicine</a></li>
<li class="chapter" data-level="6.3.3" data-path="text-analytics.html"><a href="text-analytics.html#part-3---separating-spam-from-ham"><i class="fa fa-check"></i><b>6.3.3</b> Part 3 - Separating Spam from Ham</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>7</b> Clustering</a><ul>
<li class="chapter" data-level="7.1" data-path="clustering.html"><a href="clustering.html#introduction-to-clustering"><i class="fa fa-check"></i><b>7.1</b> Introduction to Clustering</a><ul>
<li class="chapter" data-level="7.1.1" data-path="clustering.html"><a href="clustering.html#heirarchical-clustering"><i class="fa fa-check"></i><b>7.1.1</b> Heirarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="clustering.html"><a href="clustering.html#recitation---segmenting-images"><i class="fa fa-check"></i><b>7.2</b> Recitation - Segmenting Images</a><ul>
<li class="chapter" data-level="7.2.1" data-path="clustering.html"><a href="clustering.html#flower-image"><i class="fa fa-check"></i><b>7.2.1</b> Flower Image</a></li>
<li class="chapter" data-level="7.2.2" data-path="clustering.html"><a href="clustering.html#mri-image"><i class="fa fa-check"></i><b>7.2.2</b> MRI Image</a></li>
<li class="chapter" data-level="7.2.3" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>7.2.3</b> K-Means Clustering</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="clustering.html"><a href="clustering.html#assignment-5"><i class="fa fa-check"></i><b>7.3</b> Assignment</a><ul>
<li class="chapter" data-level="7.3.1" data-path="clustering.html"><a href="clustering.html#part-1---document-clustering-with-daily-kos"><i class="fa fa-check"></i><b>7.3.1</b> Part 1 - Document Clustering with Daily Kos</a></li>
<li class="chapter" data-level="7.3.2" data-path="clustering.html"><a href="clustering.html#part-2---market-segmentation-for-airlines"><i class="fa fa-check"></i><b>7.3.2</b> Part 2 - Market Segmentation for Airlines</a></li>
<li class="chapter" data-level="7.3.3" data-path="clustering.html"><a href="clustering.html#part-3---predicting-stock-returns-with-cluster-then-predict"><i class="fa fa-check"></i><b>7.3.3</b> Part 3 - Predicting Stock Returns with Cluster-Then-Predict</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>8</b> Visualization</a><ul>
<li class="chapter" data-level="8.1" data-path="visualization.html"><a href="visualization.html#scatterplots---visualizing-the-world"><i class="fa fa-check"></i><b>8.1</b> Scatterplots - Visualizing the world</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualization.html"><a href="visualization.html#basic-scatterplots-using-ggplot"><i class="fa fa-check"></i><b>8.1.1</b> Basic scatterplots using ggplot</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualization.html"><a href="visualization.html#visualizing-crime-over-time"><i class="fa fa-check"></i><b>8.2</b> Visualizing crime over time</a><ul>
<li class="chapter" data-level="8.2.1" data-path="visualization.html"><a href="visualization.html#heatmaps"><i class="fa fa-check"></i><b>8.2.1</b> Heatmaps</a></li>
<li class="chapter" data-level="8.2.2" data-path="visualization.html"><a href="visualization.html#a-geographical-hot-spot-map"><i class="fa fa-check"></i><b>8.2.2</b> A Geographical Hot Spot Map</a></li>
<li class="chapter" data-level="8.2.3" data-path="visualization.html"><a href="visualization.html#a-heatmap-of-the-united-states"><i class="fa fa-check"></i><b>8.2.3</b> A Heatmap of the United States</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualization.html"><a href="visualization.html#recitation"><i class="fa fa-check"></i><b>8.3</b> Recitation</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualization.html"><a href="visualization.html#bar-charts"><i class="fa fa-check"></i><b>8.3.1</b> Bar Charts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualization.html"><a href="visualization.html#assignment-6"><i class="fa fa-check"></i><b>8.4</b> Assignment</a><ul>
<li class="chapter" data-level="8.4.1" data-path="visualization.html"><a href="visualization.html#part-1---election-forecasting-revisited"><i class="fa fa-check"></i><b>8.4.1</b> Part 1 - Election Forecasting Revisited</a></li>
<li class="chapter" data-level="8.4.2" data-path="visualization.html"><a href="visualization.html#part-2---visualizing-network-data"><i class="fa fa-check"></i><b>8.4.2</b> Part 2 - Visualizing Network Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="final-exam.html"><a href="final-exam.html"><i class="fa fa-check"></i><b>9</b> Final Exam</a><ul>
<li class="chapter" data-level="9.1" data-path="final-exam.html"><a href="final-exam.html#part-1---estimating-miles-per-gallon"><i class="fa fa-check"></i><b>9.1</b> Part 1 - Estimating Miles Per Gallon</a><ul>
<li class="chapter" data-level="9.1.1" data-path="final-exam.html"><a href="final-exam.html#problem-1---exploratory-data-analysis"><i class="fa fa-check"></i><b>9.1.1</b> Problem 1 - Exploratory Data Analysis</a></li>
<li class="chapter" data-level="9.1.2" data-path="final-exam.html"><a href="final-exam.html#problem-2---simple-linear-regression"><i class="fa fa-check"></i><b>9.1.2</b> Problem 2 - Simple Linear Regression</a></li>
<li class="chapter" data-level="9.1.3" data-path="final-exam.html"><a href="final-exam.html#problem-3---adding-more-variables"><i class="fa fa-check"></i><b>9.1.3</b> Problem 3 - Adding More Variables</a></li>
<li class="chapter" data-level="9.1.4" data-path="final-exam.html"><a href="final-exam.html#problem-4---cart-and-randomforest"><i class="fa fa-check"></i><b>9.1.4</b> Problem 4 - CART and Randomforest</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="final-exam.html"><a href="final-exam.html#part-2---predicting-heart-disease"><i class="fa fa-check"></i><b>9.2</b> Part 2 - Predicting Heart Disease</a><ul>
<li class="chapter" data-level="9.2.1" data-path="final-exam.html"><a href="final-exam.html#problem-12---exploratory-data-analysis-and-logistic-regression"><i class="fa fa-check"></i><b>9.2.1</b> Problem 1&amp;2 - Exploratory Data Analysis and Logistic Regression</a></li>
<li class="chapter" data-level="9.2.2" data-path="final-exam.html"><a href="final-exam.html#problem-3---adding-more-variables-1"><i class="fa fa-check"></i><b>9.2.2</b> Problem 3 - Adding More Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="final-exam.html"><a href="final-exam.html#problem-4---cart"><i class="fa fa-check"></i><b>9.2.3</b> Problem 4 - CART</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="final-exam.html"><a href="final-exam.html#part-3---understanding-users-spending"><i class="fa fa-check"></i><b>9.3</b> Part 3 - Understanding Userâ€™s Spending</a><ul>
<li class="chapter" data-level="9.3.1" data-path="final-exam.html"><a href="final-exam.html#problem-1-and-2"><i class="fa fa-check"></i><b>9.3.1</b> Problem 1 and 2</a></li>
<li class="chapter" data-level="9.3.2" data-path="final-exam.html"><a href="final-exam.html#problem-3---clustering"><i class="fa fa-check"></i><b>9.3.2</b> Problem 3 - Clustering</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analytics Edge - EdX</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clustering" class="section level1">
<h1><span class="header-section-number">Unit 7</span> Clustering</h1>
<div id="introduction-to-clustering" class="section level2">
<h2><span class="header-section-number">7.1</span> Introduction to Clustering</h2>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" title="1"><span class="co">#input text file</span></a>
<a class="sourceLine" id="cb610-2" title="2">movies &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;week6/movieLens.txt&quot;</span>, <span class="dt">header=</span><span class="ot">FALSE</span>, <span class="dt">sep=</span><span class="st">&quot;|&quot;</span>,<span class="dt">quote=</span><span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb610-3" title="3"><span class="kw">str</span>(movies)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1682 obs. of  24 variables:
##  $ V1 : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ V2 : Factor w/ 1664 levels &quot;&#39;Til There Was You (1997)&quot;,..: 1525 617 554 593 343 1318 1545 110 390 1240 ...
##  $ V3 : Factor w/ 241 levels &quot;&quot;,&quot;01-Aug-1997&quot;,..: 71 71 71 71 71 71 71 71 71 182 ...
##  $ V4 : logi  NA NA NA NA NA NA ...
##  $ V5 : Factor w/ 1661 levels &quot;&quot;,&quot;http://us.imdb.com/M/title-exact/Independence%20(1997)&quot;,..: 1431 565 505 543 310 1661 1453 103 357 1183 ...
##  $ V6 : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ V7 : int  0 1 0 1 0 0 0 0 0 0 ...
##  $ V8 : int  0 1 0 0 0 0 0 0 0 0 ...
##  $ V9 : int  1 0 0 0 0 0 0 0 0 0 ...
...</code></pre>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" title="1"><span class="co"># Add column names</span></a>
<a class="sourceLine" id="cb612-2" title="2"><span class="kw">colnames</span>(movies) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Title&quot;</span>, <span class="st">&quot;ReleaseDate&quot;</span>, <span class="st">&quot;VideoReleaseDate&quot;</span>, <span class="st">&quot;IMDB&quot;</span>, <span class="st">&quot;Unknown&quot;</span>, <span class="st">&quot;Action&quot;</span>, <span class="st">&quot;Adventure&quot;</span>, <span class="st">&quot;Animation&quot;</span>, <span class="st">&quot;Childrens&quot;</span>, <span class="st">&quot;Comedy&quot;</span>, <span class="st">&quot;Crime&quot;</span>, <span class="st">&quot;Documentary&quot;</span>, <span class="st">&quot;Drama&quot;</span>, <span class="st">&quot;Fantasy&quot;</span>, <span class="st">&quot;FilmNoir&quot;</span>, <span class="st">&quot;Horror&quot;</span>, <span class="st">&quot;Musical&quot;</span>, <span class="st">&quot;Mystery&quot;</span>, <span class="st">&quot;Romance&quot;</span>, <span class="st">&quot;SciFi&quot;</span>, <span class="st">&quot;Thriller&quot;</span>, <span class="st">&quot;War&quot;</span>, <span class="st">&quot;Western&quot;</span>)</a>
<a class="sourceLine" id="cb612-3" title="3"><span class="kw">str</span>(movies)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1682 obs. of  24 variables:
##  $ ID              : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Title           : Factor w/ 1664 levels &quot;&#39;Til There Was You (1997)&quot;,..: 1525 617 554 593 343 1318 1545 110 390 1240 ...
##  $ ReleaseDate     : Factor w/ 241 levels &quot;&quot;,&quot;01-Aug-1997&quot;,..: 71 71 71 71 71 71 71 71 71 182 ...
##  $ VideoReleaseDate: logi  NA NA NA NA NA NA ...
##  $ IMDB            : Factor w/ 1661 levels &quot;&quot;,&quot;http://us.imdb.com/M/title-exact/Independence%20(1997)&quot;,..: 1431 565 505 543 310 1661 1453 103 357 1183 ...
##  $ Unknown         : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Action          : int  0 1 0 1 0 0 0 0 0 0 ...
##  $ Adventure       : int  0 1 0 0 0 0 0 0 0 0 ...
##  $ Animation       : int  1 0 0 0 0 0 0 0 0 0 ...
...</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1"><span class="co"># Remove unnecessary variables</span></a>
<a class="sourceLine" id="cb614-2" title="2">movies<span class="op">$</span>ID &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb614-3" title="3">movies<span class="op">$</span>ReleaseDate &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb614-4" title="4">movies<span class="op">$</span>VideoReleaseDate &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb614-5" title="5">movies<span class="op">$</span>IMDB &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb614-6" title="6"></a>
<a class="sourceLine" id="cb614-7" title="7"><span class="co"># Remove duplicates</span></a>
<a class="sourceLine" id="cb614-8" title="8">movies &lt;-<span class="st"> </span><span class="kw">unique</span>(movies)</a></code></pre></div>
<div id="heirarchical-clustering" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Heirarchical Clustering</h3>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" title="1"><span class="co">#Heirarchical Clustering in R</span></a>
<a class="sourceLine" id="cb615-2" title="2"><span class="co">#Cluster on genre variables not title</span></a>
<a class="sourceLine" id="cb615-3" title="3">distances &lt;-<span class="st"> </span><span class="kw">dist</span>(movies[<span class="dv">2</span><span class="op">:</span><span class="dv">20</span>], <span class="dt">method=</span> <span class="st">&quot;euclidian&quot;</span>) <span class="co">#Use euclidian distance</span></a>
<a class="sourceLine" id="cb615-4" title="4">clusterMovies &lt;-<span class="st"> </span><span class="kw">hclust</span>(distances, <span class="dt">method =</span> <span class="st">&quot;ward.D&quot;</span>) <span class="co">#The ward method cares about the distance between clusters using centroid distance, and also the variance in each of the clusters.</span></a>
<a class="sourceLine" id="cb615-5" title="5"><span class="kw">plot</span>(clusterMovies)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1"><span class="co">#label datapoint by cluster</span></a>
<a class="sourceLine" id="cb616-2" title="2">clusterGroups &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusterMovies, <span class="dt">k =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb616-3" title="3"><span class="kw">head</span>(clusterGroups)</a></code></pre></div>
<pre><code>## 1 2 3 4 5 6 
## 1 2 3 1 3 4</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1"><span class="kw">tapply</span>(movies<span class="op">$</span>Action, clusterGroups, mean)<span class="co">#Average of action by clusterGroups</span></a></code></pre></div>
<pre><code>##         1         2         3         4         5         6         7         8 
## 0.1784512 0.7839196 0.1238532 0.0000000 0.0000000 0.1015625 0.0000000 0.0000000 
##         9        10 
## 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1"><span class="kw">tapply</span>(movies<span class="op">$</span>Romance, clusterGroups, mean)<span class="co">#Average of Romance by clusterGroups</span></a></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
## 0.10437710 0.04522613 0.03669725 0.00000000 0.00000000 1.00000000 1.00000000 
##          8          9         10 
## 0.00000000 0.00000000 0.00000000</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1"><span class="co"># Find which cluster Men in Black is in.</span></a>
<a class="sourceLine" id="cb622-2" title="2"><span class="kw">subset</span>(movies, Title<span class="op">==</span><span class="st">&quot;Men in Black (1997)&quot;</span>)</a></code></pre></div>
<pre><code>##                   Title Unknown Action Adventure Animation Childrens Comedy
## 257 Men in Black (1997)       0      1         1         0         0      1
##     Crime Documentary Drama Fantasy FilmNoir Horror Musical Mystery Romance
## 257     0           0     0       0        0      0       0       0       0
##     SciFi Thriller War Western
## 257     1        0   0       0</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" title="1">clusterGroups[<span class="dv">257</span>]</a></code></pre></div>
<pre><code>## 257 
##   2</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb626-1" title="1"><span class="co"># Create a new data set with just the movies from cluster 2</span></a>
<a class="sourceLine" id="cb626-2" title="2">cluster2 &lt;-<span class="st"> </span><span class="kw">subset</span>(movies, clusterGroups<span class="op">==</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb626-3" title="3"></a>
<a class="sourceLine" id="cb626-4" title="4"><span class="co"># Look at the first 10 titles in this cluster:</span></a>
<a class="sourceLine" id="cb626-5" title="5">cluster2<span class="op">$</span>Title[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</a></code></pre></div>
<pre><code>##  [1] GoldenEye (1995)                              
##  [2] Bad Boys (1995)                               
##  [3] Apollo 13 (1995)                              
##  [4] Net, The (1995)                               
##  [5] Natural Born Killers (1994)                   
##  [6] Outbreak (1995)                               
##  [7] Stargate (1994)                               
##  [8] Fugitive, The (1993)                          
##  [9] Jurassic Park (1993)                          
## [10] Robert A. Heinlein&#39;s The Puppet Masters (1994)
...</code></pre>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb628-1" title="1"><span class="co">#An advanced approach to finding cluster centroids</span></a>
<a class="sourceLine" id="cb628-2" title="2">cG &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusterMovies, <span class="dt">k =</span> <span class="dv">2</span>) <span class="co">#only 2 clusters</span></a>
<a class="sourceLine" id="cb628-3" title="3">spl &lt;-<span class="st"> </span><span class="kw">split</span>(movies[<span class="dv">2</span><span class="op">:</span><span class="dv">20</span>], cG)<span class="co">#Split movies by cluster groups</span></a>
<a class="sourceLine" id="cb628-4" title="4"><span class="kw">lapply</span>(spl, colMeans)</a></code></pre></div>
<pre><code>## $`1`
##     Unknown      Action   Adventure   Animation   Childrens      Comedy 
## 0.001545595 0.192426584 0.102782071 0.032457496 0.092735703 0.387944359 
##       Crime Documentary       Drama     Fantasy    FilmNoir      Horror 
## 0.082689335 0.038639876 0.267387944 0.017001546 0.018547141 0.069551777 
##     Musical     Mystery     Romance       SciFi    Thriller         War 
## 0.043276662 0.046367852 0.188562597 0.077279753 0.191653787 0.054868624 
##     Western 
## 0.020865533 
## 
...</code></pre>
</div>
</div>
<div id="recitation---segmenting-images" class="section level2">
<h2><span class="header-section-number">7.2</span> Recitation - Segmenting Images</h2>
<div id="flower-image" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Flower Image</h3>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb630-1" title="1">flower &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week6/flower.csv&quot;</span>, <span class="dt">header =</span> F)</a>
<a class="sourceLine" id="cb630-2" title="2">flowerMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(flower)</a>
<a class="sourceLine" id="cb630-3" title="3">flowerVector &lt;-<span class="st"> </span><span class="kw">as.vector</span>(flowerMatrix) <span class="co">#convert to vector to calculate euclidian distances for clustering</span></a>
<a class="sourceLine" id="cb630-4" title="4">distance &lt;-<span class="st"> </span><span class="kw">dist</span>(flowerVector, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>)</a>
<a class="sourceLine" id="cb630-5" title="5"></a>
<a class="sourceLine" id="cb630-6" title="6"><span class="co"># Hierarchical clustering</span></a>
<a class="sourceLine" id="cb630-7" title="7">clusterIntensity &lt;-<span class="st"> </span><span class="kw">hclust</span>(distance, <span class="dt">method=</span><span class="st">&quot;ward.D&quot;</span>)<span class="co">#ward method is minimum variance method.</span></a>
<a class="sourceLine" id="cb630-8" title="8"><span class="kw">plot</span>(clusterIntensity)</a>
<a class="sourceLine" id="cb630-9" title="9"><span class="co"># Select 3 clusters</span></a>
<a class="sourceLine" id="cb630-10" title="10"><span class="kw">rect.hclust</span>(clusterIntensity, <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb631-1" title="1">flowerClusters &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusterIntensity, <span class="dt">k =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb631-2" title="2"></a>
<a class="sourceLine" id="cb631-3" title="3"><span class="kw">tapply</span>(flowerVector, flowerClusters, mean)</a></code></pre></div>
<pre><code>##          1          2          3 
## 0.08574315 0.50826255 0.93147713</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb633-1" title="1"><span class="co">#plot the image and clusters</span></a>
<a class="sourceLine" id="cb633-2" title="2"><span class="kw">dim</span>(flowerClusters) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>) <span class="co">#Set the dimensions as 50x50 to look like a matrix</span></a>
<a class="sourceLine" id="cb633-3" title="3"><span class="kw">image</span>(flowerClusters, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-99-2.png" width="672" /></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1"><span class="kw">image</span>(flowerMatrix,<span class="dt">axes=</span><span class="ot">FALSE</span>,<span class="dt">col=</span><span class="kw">grey</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">length=</span><span class="dv">256</span>)))<span class="co">#original image in grayscale</span></a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-99-3.png" width="672" /></p>
</div>
<div id="mri-image" class="section level3">
<h3><span class="header-section-number">7.2.2</span> MRI Image</h3>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb635-1" title="1">healthy &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week6/healthy.csv&quot;</span>, <span class="dt">header =</span> F)</a>
<a class="sourceLine" id="cb635-2" title="2">healthyMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(healthy)</a>
<a class="sourceLine" id="cb635-3" title="3"></a>
<a class="sourceLine" id="cb635-4" title="4"><span class="co">#Plot image</span></a>
<a class="sourceLine" id="cb635-5" title="5"><span class="kw">image</span>(healthyMatrix,<span class="dt">axes=</span><span class="ot">FALSE</span>,<span class="dt">col=</span><span class="kw">grey</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">length=</span><span class="dv">256</span>)))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb636-1" title="1">healthyVector &lt;-<span class="st"> </span><span class="kw">as.vector</span>(healthyMatrix)</a>
<a class="sourceLine" id="cb636-2" title="2"><span class="co">#distance &lt;- dist(healthyVector, method = &quot;euclidean&quot;) - Error, We&#39;ll use k-means clusering instead</span></a></code></pre></div>
</div>
<div id="k-means-clustering" class="section level3">
<h3><span class="header-section-number">7.2.3</span> K-Means Clustering</h3>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb637-1" title="1"><span class="co">#K-means clustering</span></a>
<a class="sourceLine" id="cb637-2" title="2">k&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb637-3" title="3"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb637-4" title="4">KMC &lt;-<span class="st"> </span><span class="kw">kmeans</span>(healthyVector, <span class="dt">centers =</span> k, <span class="dt">iter.max =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb637-5" title="5"><span class="kw">str</span>(KMC)</a></code></pre></div>
<pre><code>## List of 9
##  $ cluster     : int [1:365636] 5 5 5 5 5 5 5 5 5 5 ...
##  $ centers     : num [1:5, 1] 0.1166 0.2014 0.4914 0.3299 0.0219
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : NULL
##  $ totss       : num 5775
##  $ withinss    : num [1:5] 65.9 54.4 81.1 47.4 53.3
##  $ tot.withinss: num 302
##  $ betweenss   : num 5473
...</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb639-1" title="1"><span class="co"># Extract clusters</span></a>
<a class="sourceLine" id="cb639-2" title="2">healthyClusters &lt;-<span class="st"> </span>KMC<span class="op">$</span>cluster</a>
<a class="sourceLine" id="cb639-3" title="3"></a>
<a class="sourceLine" id="cb639-4" title="4"><span class="co"># Plot the image with the clusters</span></a>
<a class="sourceLine" id="cb639-5" title="5"><span class="kw">dim</span>(healthyClusters) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nrow</span>(healthyMatrix), <span class="kw">ncol</span>(healthyMatrix))<span class="co"># set dimensions</span></a>
<a class="sourceLine" id="cb639-6" title="6"><span class="kw">image</span>(healthyClusters, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col=</span><span class="kw">rainbow</span>(k))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb640-1" title="1"><span class="co">#Detecting Tumors</span></a>
<a class="sourceLine" id="cb640-2" title="2">tumor &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week6/tumor.csv&quot;</span>, <span class="dt">header=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb640-3" title="3">tumorMatrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tumor)</a>
<a class="sourceLine" id="cb640-4" title="4">tumorVector &lt;-<span class="st"> </span><span class="kw">as.vector</span>(tumorMatrix)</a>
<a class="sourceLine" id="cb640-5" title="5"></a>
<a class="sourceLine" id="cb640-6" title="6"><span class="co">#Apply clusters</span></a>
<a class="sourceLine" id="cb640-7" title="7"><span class="kw">library</span>(flexclust)</a>
<a class="sourceLine" id="cb640-8" title="8"></a>
<a class="sourceLine" id="cb640-9" title="9">KMC.kcca &lt;-<span class="st"> </span><span class="kw">as.kcca</span>(KMC, healthyVector)<span class="co">#convert to kcca object</span></a>
<a class="sourceLine" id="cb640-10" title="10">tumorClusters &lt;-<span class="st"> </span><span class="kw">predict</span>(KMC.kcca, <span class="dt">newdata =</span> tumorVector)</a>
<a class="sourceLine" id="cb640-11" title="11"></a>
<a class="sourceLine" id="cb640-12" title="12"><span class="co"># Visualize the clusters</span></a>
<a class="sourceLine" id="cb640-13" title="13"><span class="kw">dim</span>(tumorClusters) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nrow</span>(tumorMatrix), <span class="kw">ncol</span>(tumorMatrix))</a>
<a class="sourceLine" id="cb640-14" title="14"><span class="kw">image</span>(tumorClusters, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col=</span><span class="kw">rainbow</span>(k))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-101-2.png" width="672" /></p>
</div>
</div>
<div id="assignment-5" class="section level2">
<h2><span class="header-section-number">7.3</span> Assignment</h2>
<div id="part-1---document-clustering-with-daily-kos" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Part 1 - Document Clustering with Daily Kos</h3>
<div id="problem-1---hierarchical-clustering" class="section level4">
<h4><span class="header-section-number">7.3.1.1</span> Problem 1 - Hierarchical Clustering</h4>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb641-1" title="1"><span class="co">#1.1</span></a>
<a class="sourceLine" id="cb641-2" title="2">dailyKos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week6/dailykos.csv&quot;</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb641-3" title="3"><span class="kw">str</span>(dailyKos)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3430 obs. of  1545 variables:
##  $ abandon                                 : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ abc                                     : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ability                                 : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ abortion                                : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ absolute                                : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ abstain                                 : int  0 0 1 0 0 0 0 0 0 0 ...
##  $ abu                                     : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ abuse                                   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ accept                                  : int  0 0 0 0 0 0 0 0 0 0 ...
...</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb643-1" title="1">distances &lt;-<span class="st"> </span><span class="kw">dist</span>(dailyKos, <span class="dt">method=</span> <span class="st">&quot;euclidian&quot;</span>)</a>
<a class="sourceLine" id="cb643-2" title="2">clusterKos &lt;-<span class="st"> </span><span class="kw">hclust</span>(distances, <span class="dt">method =</span> <span class="st">&quot;ward.D&quot;</span>)</a>
<a class="sourceLine" id="cb643-3" title="3"><span class="kw">plot</span>(clusterKos)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb644-1" title="1"><span class="co">#1.4 Use the cutree function to split your data into 7 clusters.; How many observations are in cluster 3?</span></a>
<a class="sourceLine" id="cb644-2" title="2">clusterGroups &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusterKos, <span class="dt">k =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb644-3" title="3">spl &lt;-<span class="st"> </span><span class="kw">split</span>(dailyKos, clusterGroups)<span class="co">#Split movies by cluster groups</span></a>
<a class="sourceLine" id="cb644-4" title="4"><span class="kw">lapply</span>(spl, nrow)</a></code></pre></div>
<pre><code>## $`1`
## [1] 1266
## 
## $`2`
## [1] 321
## 
## $`3`
## [1] 374
## 
## $`4`
...</code></pre>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb646-1" title="1"><span class="co">#1.5 look at the top 6 words in each cluster</span></a>
<a class="sourceLine" id="cb646-2" title="2"><span class="co">#sort - orders in increasing value; tail - last 6 values</span></a>
<a class="sourceLine" id="cb646-3" title="3">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb646-4" title="4">  <span class="kw">tail</span>(<span class="kw">sort</span>(<span class="kw">colMeans</span>(x)))</a>
<a class="sourceLine" id="cb646-5" title="5">}</a>
<a class="sourceLine" id="cb646-6" title="6"><span class="kw">lapply</span>(spl, f)</a></code></pre></div>
<pre><code>## $`1`
##      state republican       poll   democrat      kerry       bush 
##  0.7575039  0.7590837  0.9036335  0.9194313  1.0624013  1.7053712 
## 
## $`2`
##      bush  democrat challenge      vote      poll  november 
##  2.847352  2.850467  4.096573  4.398754  4.847352 10.339564 
## 
## $`3`
##      elect    parties      state republican   democrat       bush 
...</code></pre>
</div>
<div id="problem-2---k-means-clustering" class="section level4">
<h4><span class="header-section-number">7.3.1.2</span> Problem 2 - K-Means Clustering</h4>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb648-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb648-2" title="2">KMC &lt;-<span class="st"> </span><span class="kw">kmeans</span>(dailyKos, <span class="dt">centers =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb648-3" title="3"><span class="kw">str</span>(KMC)</a></code></pre></div>
<pre><code>## List of 9
##  $ cluster     : int [1:3430] 4 4 2 4 1 4 3 4 4 4 ...
##  $ centers     : num [1:7, 1:1545] 0.0333 0.0152 0.03 0.0138 0.0556 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:7] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:1545] &quot;abandon&quot; &quot;abc&quot; &quot;ability&quot; &quot;abortion&quot; ...
##  $ totss       : num 896461
##  $ withinss    : num [1:7] 77738 77220 75280 245827 53122 ...
##  $ tot.withinss: num 730614
##  $ betweenss   : num 165847
...</code></pre>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb650-1" title="1">splK &lt;-<span class="st"> </span><span class="kw">split</span>(dailyKos, KMC<span class="op">$</span>cluster)</a>
<a class="sourceLine" id="cb650-2" title="2"><span class="kw">lapply</span>(splK, nrow)</a></code></pre></div>
<pre><code>## $`1`
## [1] 150
## 
## $`2`
## [1] 329
## 
## $`3`
## [1] 300
## 
## $`4`
...</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb652-1" title="1"><span class="kw">lapply</span>(splK, f)</a></code></pre></div>
<pre><code>## $`1`
##           time           iraq          kerry administration       presided 
##       1.586667       1.640000       1.653333       2.620000       2.726667 
##           bush 
##      11.333333 
## 
## $`2`
##  democrat      bush challenge      vote      poll  november 
##  2.899696  2.960486  4.121581  4.446809  4.872340 10.370821 
## 
...</code></pre>
</div>
</div>
<div id="part-2---market-segmentation-for-airlines" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Part 2 - Market Segmentation for Airlines</h3>
<div id="problem-1---normalizing-the-data" class="section level4">
<h4><span class="header-section-number">7.3.2.1</span> Problem 1 - Normalizing the Data</h4>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" title="1">airlines &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week6/AirlinesCluster.csv&quot;</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb654-2" title="2"><span class="kw">summary</span>(airlines)</a></code></pre></div>
<pre><code>##     Balance          QualMiles         BonusMiles       BonusTrans  
##  Min.   :      0   Min.   :    0.0   Min.   :     0   Min.   : 0.0  
##  1st Qu.:  18528   1st Qu.:    0.0   1st Qu.:  1250   1st Qu.: 3.0  
##  Median :  43097   Median :    0.0   Median :  7171   Median :12.0  
##  Mean   :  73601   Mean   :  144.1   Mean   : 17145   Mean   :11.6  
##  3rd Qu.:  92404   3rd Qu.:    0.0   3rd Qu.: 23801   3rd Qu.:17.0  
##  Max.   :1704838   Max.   :11148.0   Max.   :263685   Max.   :86.0  
##   FlightMiles       FlightTrans     DaysSinceEnroll
##  Min.   :    0.0   Min.   : 0.000   Min.   :   2   
##  1st Qu.:    0.0   1st Qu.: 0.000   1st Qu.:2330   
...</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" title="1"><span class="co">#1.3 In the normalized data, which variable has the largest maximum value?</span></a>
<a class="sourceLine" id="cb656-2" title="2">preproc &lt;-<span class="st"> </span><span class="kw">preProcess</span>(airlines) <span class="co">#pre process data</span></a>
<a class="sourceLine" id="cb656-3" title="3">airlinesNorm &lt;-<span class="st"> </span><span class="kw">predict</span>(preproc, airlines)</a>
<a class="sourceLine" id="cb656-4" title="4"><span class="kw">summary</span>(airlinesNorm)</a></code></pre></div>
<pre><code>##     Balance          QualMiles         BonusMiles        BonusTrans      
##  Min.   :-0.7303   Min.   :-0.1863   Min.   :-0.7099   Min.   :-1.20805  
##  1st Qu.:-0.5465   1st Qu.:-0.1863   1st Qu.:-0.6581   1st Qu.:-0.89568  
##  Median :-0.3027   Median :-0.1863   Median :-0.4130   Median : 0.04145  
##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000  
##  3rd Qu.: 0.1866   3rd Qu.:-0.1863   3rd Qu.: 0.2756   3rd Qu.: 0.56208  
##  Max.   :16.1868   Max.   :14.2231   Max.   :10.2083   Max.   : 7.74673  
##   FlightMiles       FlightTrans       DaysSinceEnroll   
##  Min.   :-0.3286   Min.   :-0.36212   Min.   :-1.99336  
##  1st Qu.:-0.3286   1st Qu.:-0.36212   1st Qu.:-0.86607  
...</code></pre>
</div>
<div id="problem-2---hierarchical-clustering" class="section level4">
<h4><span class="header-section-number">7.3.2.2</span> Problem 2 - Hierarchical Clustering</h4>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb658-1" title="1">distanceAir &lt;-<span class="st"> </span><span class="kw">dist</span>(airlinesNorm, <span class="dt">method=</span> <span class="st">&quot;euclidian&quot;</span>)</a>
<a class="sourceLine" id="cb658-2" title="2">clusterAir &lt;-<span class="st"> </span><span class="kw">hclust</span>(distanceAir, <span class="dt">method =</span> <span class="st">&quot;ward.D&quot;</span>)</a>
<a class="sourceLine" id="cb658-3" title="3"><span class="kw">plot</span>(clusterAir)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb659-1" title="1"><span class="co">#2.2 - How many data points are in Cluster 1?</span></a>
<a class="sourceLine" id="cb659-2" title="2">clusterGroupsAir &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusterAir, <span class="dt">k =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb659-3" title="3">spl &lt;-<span class="st"> </span><span class="kw">split</span>(airlines, clusterGroupsAir)<span class="co">#Split movies by cluster groups</span></a>
<a class="sourceLine" id="cb659-4" title="4"><span class="kw">lapply</span>(spl, nrow)</a></code></pre></div>
<pre><code>## $`1`
## [1] 776
## 
## $`2`
## [1] 519
## 
## $`3`
## [1] 494
## 
## $`4`
...</code></pre>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb661-1" title="1"><span class="co">#2.3</span></a>
<a class="sourceLine" id="cb661-2" title="2"><span class="kw">lapply</span>(spl, colMeans)</a></code></pre></div>
<pre><code>## $`1`
##         Balance       QualMiles      BonusMiles      BonusTrans     FlightMiles 
##    5.786690e+04    6.443299e-01    1.036012e+04    1.082345e+01    8.318428e+01 
##     FlightTrans DaysSinceEnroll 
##    3.028351e-01    6.235365e+03 
## 
## $`2`
##         Balance       QualMiles      BonusMiles      BonusTrans     FlightMiles 
##    1.106693e+05    1.065983e+03    2.288176e+04    1.822929e+01    2.613418e+03 
##     FlightTrans DaysSinceEnroll 
...</code></pre>
</div>
<div id="problem-3---k-means-clustering" class="section level4">
<h4><span class="header-section-number">7.3.2.3</span> Problem 3 - K-Means Clustering</h4>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb663-1" title="1"><span class="kw">set.seed</span>(<span class="dv">88</span>)</a>
<a class="sourceLine" id="cb663-2" title="2">KMCAir &lt;-<span class="st"> </span><span class="kw">kmeans</span>(airlinesNorm, <span class="dt">centers =</span> <span class="dv">5</span>, <span class="dt">iter.max =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb663-3" title="3"><span class="kw">str</span>(KMCAir)</a></code></pre></div>
<pre><code>## List of 9
##  $ cluster     : int [1:3999] 4 4 4 4 1 4 1 4 3 1 ...
##  $ centers     : num [1:5, 1:7] 0.787 0.401 1.172 -0.161 -0.352 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:7] &quot;Balance&quot; &quot;QualMiles&quot; &quot;BonusMiles&quot; &quot;BonusTrans&quot; ...
##  $ totss       : num 27986
##  $ withinss    : num [1:5] 4440 704 3571 2422 2374
##  $ tot.withinss: num 13511
##  $ betweenss   : num 14475
...</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb665-1" title="1"><span class="co">#3.1 - How many clusters have more than 1,000 observations?</span></a>
<a class="sourceLine" id="cb665-2" title="2">splK &lt;-<span class="st"> </span><span class="kw">split</span>(airlines, KMCAir<span class="op">$</span>cluster)</a>
<a class="sourceLine" id="cb665-3" title="3"><span class="kw">lapply</span>(splK, nrow)</a></code></pre></div>
<pre><code>## $`1`
## [1] 776
## 
## $`2`
## [1] 57
## 
## $`3`
## [1] 143
## 
## $`4`
...</code></pre>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb667-1" title="1"><span class="co">#3.2</span></a>
<a class="sourceLine" id="cb667-2" title="2">KMCAir<span class="op">$</span>centers</a></code></pre></div>
<pre><code>##      Balance   QualMiles  BonusMiles  BonusTrans FlightMiles FlightTrans
## 1  0.7866778 -0.08547306  1.40214847  1.01145492  0.01417749  0.02211363
## 2  0.4009981  6.97876620  0.08495883  0.07250717  0.34260322  0.38252097
## 3  1.1722573  0.42324832  0.66036647  1.74459327  3.78734636  4.05877606
## 4 -0.1606061 -0.11505046 -0.34731771 -0.26038231 -0.17602747 -0.19180853
## 5 -0.3517815 -0.14183200 -0.43059094 -0.41272355 -0.20026359 -0.21576712
##   DaysSinceEnroll
## 1       0.3859187
## 2      -0.1193065
## 3       0.2652869
...</code></pre>
</div>
</div>
<div id="part-3---predicting-stock-returns-with-cluster-then-predict" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Part 3 - Predicting Stock Returns with Cluster-Then-Predict</h3>
<div id="problem-1---exploring-the-dataset" class="section level4">
<h4><span class="header-section-number">7.3.3.1</span> Problem 1 - Exploring the Dataset</h4>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb669-1" title="1"><span class="co">#1.1</span></a>
<a class="sourceLine" id="cb669-2" title="2">stocks &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week6/StocksCluster.csv&quot;</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb669-3" title="3"><span class="co">#1.2, 1.3, 1.4</span></a>
<a class="sourceLine" id="cb669-4" title="4"><span class="kw">summary</span>(stocks)</a></code></pre></div>
<pre><code>##    ReturnJan            ReturnFeb           ReturnMar        
##  Min.   :-0.7616205   Min.   :-0.690000   Min.   :-0.712994  
##  1st Qu.:-0.0691663   1st Qu.:-0.077748   1st Qu.:-0.046389  
##  Median : 0.0009965   Median :-0.010626   Median : 0.009878  
##  Mean   : 0.0126316   Mean   :-0.007605   Mean   : 0.019402  
##  3rd Qu.: 0.0732606   3rd Qu.: 0.043600   3rd Qu.: 0.077066  
##  Max.   : 3.0683060   Max.   : 6.943694   Max.   : 4.008621  
##    ReturnApr           ReturnMay          ReturnJune       
##  Min.   :-0.826503   Min.   :-0.92207   Min.   :-0.717920  
##  1st Qu.:-0.054468   1st Qu.:-0.04640   1st Qu.:-0.063966  
...</code></pre>
</div>
<div id="problem-2---initial-logistic-regression-model" class="section level4">
<h4><span class="header-section-number">7.3.3.2</span> Problem 2 - Initial Logistic Regression Model</h4>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb671-1" title="1"><span class="co">#2.1 - What is the overall accuracy on the training set, using a threshold of 0.5?</span></a>
<a class="sourceLine" id="cb671-2" title="2"><span class="kw">set.seed</span>(<span class="dv">144</span>)</a>
<a class="sourceLine" id="cb671-3" title="3">splitStocks &lt;-<span class="st"> </span><span class="kw">sample.split</span>(stocks<span class="op">$</span>PositiveDec, <span class="dt">SplitRatio =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb671-4" title="4">stocksTrain &lt;-<span class="st"> </span><span class="kw">subset</span>(stocks, splitStocks <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb671-5" title="5">stocksTest &lt;-<span class="st"> </span><span class="kw">subset</span>(stocks, splitStocks <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb671-6" title="6">StocksModel &lt;-<span class="st"> </span><span class="kw">glm</span>(PositiveDec <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span>stocksTrain, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span> )</a>
<a class="sourceLine" id="cb671-7" title="7">stocksLogPrediction &lt;-<span class="st"> </span><span class="kw">predict</span>(StocksModel, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb671-8" title="8"><span class="kw">table</span>(stocksTrain<span class="op">$</span>PositiveDec, stocksLogPrediction <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0   990 2689
##   1   787 3640</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb673-1" title="1">(<span class="dv">990</span> <span class="op">+</span><span class="dv">3640</span>)<span class="op">/</span><span class="kw">nrow</span>(stocksTrain) <span class="co">#Accuracy - 0.5711818</span></a></code></pre></div>
<pre><code>## [1] 0.5711818</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb675-1" title="1"><span class="co">#2.2Now obtain test set predictions from StocksModel. What is the overall accuracy of the model on the test, again using a threshold of 0.5?</span></a>
<a class="sourceLine" id="cb675-2" title="2">stocksLogPrediction &lt;-<span class="st"> </span><span class="kw">predict</span>(StocksModel, <span class="dt">newdata =</span> stocksTest, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb675-3" title="3"><span class="kw">table</span>(stocksTest<span class="op">$</span>PositiveDec, stocksLogPrediction <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0   417 1160
##   1   344 1553</code></pre>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb677-1" title="1">(<span class="dv">417</span> <span class="op">+</span><span class="dv">1553</span>)<span class="op">/</span><span class="kw">nrow</span>(stocksTest) <span class="co">#Accuracy - 0.5670697</span></a></code></pre></div>
<pre><code>## [1] 0.5670697</code></pre>
</div>
<div id="problem-3---clustering-stocks" class="section level4">
<h4><span class="header-section-number">7.3.3.3</span> Problem 3 - Clustering Stocks</h4>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1"><span class="co">#3.1Why do we need to remove the dependent variable in the clustering phase of the cluster-then-predict methodology?</span></a>
<a class="sourceLine" id="cb679-2" title="2"><span class="co">#Ans - Thats the variable we&#39;re trying to predict</span></a>
<a class="sourceLine" id="cb679-3" title="3">limitedTrain &lt;-<span class="st"> </span>stocksTrain</a>
<a class="sourceLine" id="cb679-4" title="4">limitedTrain<span class="op">$</span>PositiveDec &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb679-5" title="5">limitedTest &lt;-<span class="st"> </span>stocksTest</a>
<a class="sourceLine" id="cb679-6" title="6">limitedTest<span class="op">$</span>PositiveDec &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb679-7" title="7"></a>
<a class="sourceLine" id="cb679-8" title="8"><span class="co">#3.3</span></a>
<a class="sourceLine" id="cb679-9" title="9">preproc &lt;-<span class="st"> </span><span class="kw">preProcess</span>(limitedTrain)</a>
<a class="sourceLine" id="cb679-10" title="10">normTrain &lt;-<span class="st"> </span><span class="kw">predict</span>(preproc, limitedTrain)<span class="co">#normalize Train data</span></a>
<a class="sourceLine" id="cb679-11" title="11">normTest &lt;-<span class="st"> </span><span class="kw">predict</span>(preproc, limitedTest)<span class="co">#normalize Test data</span></a>
<a class="sourceLine" id="cb679-12" title="12"><span class="kw">summary</span>(normTest)</a></code></pre></div>
<pre><code>##    ReturnJan           ReturnFeb           ReturnMar          ReturnApr       
##  Min.   :-3.743836   Min.   :-3.251044   Min.   :-4.07731   Min.   :-4.47865  
##  1st Qu.:-0.485690   1st Qu.:-0.348951   1st Qu.:-0.40662   1st Qu.:-0.51121  
##  Median :-0.066856   Median :-0.006860   Median :-0.05674   Median :-0.11414  
##  Mean   :-0.000419   Mean   :-0.003862   Mean   : 0.00583   Mean   :-0.03638  
##  3rd Qu.: 0.357729   3rd Qu.: 0.264647   3rd Qu.: 0.35653   3rd Qu.: 0.32742  
##  Max.   : 8.412973   Max.   : 9.552365   Max.   : 9.00982   Max.   : 6.84589  
##    ReturnMay          ReturnJune         ReturnJuly          ReturnAug       
##  Min.   :-5.84445   Min.   :-4.73628   Min.   :-5.201454   Min.   :-4.62097  
##  1st Qu.:-0.43819   1st Qu.:-0.44968   1st Qu.:-0.512039   1st Qu.:-0.51546  
...</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb681-1" title="1"><span class="kw">summary</span>(normTrain)</a></code></pre></div>
<pre><code>##    ReturnJan          ReturnFeb          ReturnMar          ReturnApr      
##  Min.   :-4.57682   Min.   :-3.43004   Min.   :-4.54609   Min.   :-5.0227  
##  1st Qu.:-0.48271   1st Qu.:-0.35589   1st Qu.:-0.40758   1st Qu.:-0.4757  
##  Median :-0.07055   Median :-0.01875   Median :-0.05778   Median :-0.1104  
##  Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000  
##  3rd Qu.: 0.35898   3rd Qu.: 0.25337   3rd Qu.: 0.36106   3rd Qu.: 0.3400  
##  Max.   :18.06234   Max.   :34.92751   Max.   :24.77296   Max.   :14.6959  
##    ReturnMay          ReturnJune         ReturnJuly         ReturnAug       
##  Min.   :-4.96759   Min.   :-4.82957   Min.   :-5.19139   Min.   :-5.60378  
##  1st Qu.:-0.43045   1st Qu.:-0.45602   1st Qu.:-0.51832   1st Qu.:-0.47163  
...</code></pre>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb683-1" title="1"><span class="co">#3.4 Run k-means clustering with 3 clusters on normTrain; Which cluster has the largest number of observations?</span></a>
<a class="sourceLine" id="cb683-2" title="2"><span class="kw">set.seed</span>(<span class="dv">144</span>)</a>
<a class="sourceLine" id="cb683-3" title="3">km &lt;-<span class="st"> </span><span class="kw">kmeans</span>(normTrain, <span class="dt">centers =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb683-4" title="4">splitTrain &lt;-<span class="st"> </span><span class="kw">split</span>(normTrain, km<span class="op">$</span>cluster)</a>
<a class="sourceLine" id="cb683-5" title="5"><span class="kw">lapply</span>(splitTrain, nrow) <span class="co">#Ans - Cluster 2</span></a></code></pre></div>
<pre><code>## $`1`
## [1] 2479
## 
## $`2`
## [1] 4731
## 
## $`3`
## [1] 896</code></pre>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb685-1" title="1"><span class="co">#3.5</span></a>
<a class="sourceLine" id="cb685-2" title="2">km.kcca &lt;-<span class="st"> </span><span class="kw">as.kcca</span>(km, normTrain)</a>
<a class="sourceLine" id="cb685-3" title="3">clusterTrain &lt;-<span class="st"> </span><span class="kw">predict</span>(km.kcca)</a>
<a class="sourceLine" id="cb685-4" title="4">clusterTest &lt;-<span class="st"> </span><span class="kw">predict</span>(km.kcca, <span class="dt">newdata=</span>normTest)</a>
<a class="sourceLine" id="cb685-5" title="5"><span class="kw">table</span>(clusterTest)</a></code></pre></div>
<pre><code>## clusterTest
##    1    2    3 
## 1058 2029  387</code></pre>
</div>
<div id="problem-4---cluster-specific-predictions" class="section level4">
<h4><span class="header-section-number">7.3.3.4</span> Problem 4 - Cluster-Specific Predictions</h4>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb687-1" title="1"><span class="co">#4.1 - Which training set data frame has the highest average value of the dependent variable?</span></a>
<a class="sourceLine" id="cb687-2" title="2">trainList &lt;-<span class="st"> </span><span class="kw">split</span>(stocksTrain, clusterTrain)</a>
<a class="sourceLine" id="cb687-3" title="3">testList &lt;-<span class="st"> </span><span class="kw">split</span>(stocksTest, clusterTest)</a>
<a class="sourceLine" id="cb687-4" title="4"><span class="kw">lapply</span>(trainList, colMeans)</a></code></pre></div>
<pre><code>## $`1`
##   ReturnJan   ReturnFeb   ReturnMar   ReturnApr   ReturnMay  ReturnJune 
## -0.06884016 -0.05313853  0.05623781  0.09255203  0.08198363 -0.04521849 
##  ReturnJuly   ReturnAug   ReturnSep   ReturnOct   ReturnNov PositiveDec 
##  0.11018728  0.02208732 -0.01220414 -0.05505619 -0.01892736  0.61032674 
## 
## $`2`
##     ReturnJan     ReturnFeb     ReturnMar     ReturnApr     ReturnMay 
##  0.0251634954  0.0350812572 -0.0002492554 -0.0178523286 -0.0067017781 
##    ReturnJune    ReturnJuly     ReturnAug     ReturnSep     ReturnOct 
...</code></pre>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb689-1" title="1"><span class="co">#4.2 - </span></a>
<a class="sourceLine" id="cb689-2" title="2">fmod &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb689-3" title="3">  <span class="kw">glm</span>(PositiveDec <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> x, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb689-4" title="4">}</a>
<a class="sourceLine" id="cb689-5" title="5">trainModelList &lt;-<span class="st"> </span><span class="kw">lapply</span>(trainList, fmod)</a>
<a class="sourceLine" id="cb689-6" title="6"><span class="kw">lapply</span>(trainModelList, summary)</a></code></pre></div>
<pre><code>## $`1`
## 
## Call:
## glm(formula = PositiveDec ~ ., family = &quot;binomial&quot;, data = x)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7220  -1.2879   0.8679   1.0096   1.7170  
## 
## Coefficients:
...</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" title="1">fpredict &lt;-<span class="st"> </span><span class="cf">function</span>(modelInput, newdataInput){</a>
<a class="sourceLine" id="cb691-2" title="2">  <span class="kw">predict</span>(modelInput, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">newdata =</span>newdataInput )</a>
<a class="sourceLine" id="cb691-3" title="3">}</a>
<a class="sourceLine" id="cb691-4" title="4">predList &lt;-<span class="st"> </span><span class="kw">mapply</span>(fpredict, trainModelList, testList)</a>
<a class="sourceLine" id="cb691-5" title="5"><span class="kw">str</span>(predList[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>##  Named num [1:1058] 0.638 0.54 0.49 0.589 0.531 ...
##  - attr(*, &quot;names&quot;)= chr [1:1058] &quot;5&quot; &quot;29&quot; &quot;67&quot; &quot;86&quot; ...</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb693-1" title="1"><span class="kw">table</span>(testList[[<span class="dv">1</span>]]<span class="op">$</span>PositiveDec ,predList[[<span class="dv">1</span>]] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0    43  350
##   1    26  639</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb695-1" title="1">(<span class="dv">30</span><span class="op">+</span><span class="dv">774</span>)<span class="op">/</span>(<span class="dv">30</span><span class="op">+</span><span class="dv">774</span><span class="op">+</span><span class="dv">471</span><span class="op">+</span><span class="dv">23</span>)<span class="co">#Accuracy - 0.6194145</span></a></code></pre></div>
<pre><code>## [1] 0.6194145</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb697-1" title="1"><span class="kw">table</span>(testList[[<span class="dv">2</span>]]<span class="op">$</span>PositiveDec ,predList[[<span class="dv">2</span>]] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0   277  719
##   1   221  812</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" title="1">(<span class="dv">388</span><span class="op">+</span><span class="dv">757</span>)<span class="op">/</span>(<span class="dv">388</span><span class="op">+</span><span class="dv">757</span><span class="op">+</span><span class="dv">309</span><span class="op">+</span><span class="dv">626</span>)<span class="co">#Accuracy - 0.5504808</span></a></code></pre></div>
<pre><code>## [1] 0.5504808</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1"><span class="kw">table</span>(testList[[<span class="dv">3</span>]]<span class="op">$</span>PositiveDec ,predList[[<span class="dv">3</span>]] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0   119   69
##   1    76  123</code></pre>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" title="1">(<span class="dv">49</span><span class="op">+</span><span class="dv">13</span>)<span class="op">/</span>(<span class="dv">49</span><span class="op">+</span><span class="dv">13</span><span class="op">+</span><span class="dv">13</span><span class="op">+</span><span class="dv">21</span>)<span class="co">#Accuracy - 0.6458333</span></a></code></pre></div>
<pre><code>## [1] 0.6458333</code></pre>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" title="1">AllPredictions &lt;-<span class="st"> </span><span class="kw">c</span>(predList[[<span class="dv">1</span>]],predList[[<span class="dv">2</span>]],predList[[<span class="dv">3</span>]])</a>
<a class="sourceLine" id="cb705-2" title="2">AllOutcomes &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>,testList)</a>
<a class="sourceLine" id="cb705-3" title="3"><span class="kw">table</span>(AllOutcomes<span class="op">$</span>PositiveDec ,AllPredictions <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##    
##     FALSE TRUE
##   0   439 1138
##   1   323 1574</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" title="1">(<span class="dv">467</span><span class="op">+</span><span class="dv">1544</span>)<span class="op">/</span>(<span class="kw">nrow</span>(AllOutcomes))<span class="co">#Accuracy - 0.5788716</span></a></code></pre></div>
<pre><code>## [1] 0.5788716</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="text-analytics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"download": ["pdf", "epub"]
}
});
});
</script>

</body>

</html>
