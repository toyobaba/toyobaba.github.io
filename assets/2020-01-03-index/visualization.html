<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Unit 8 Visualization | Analytics Edge - EdX</title>
  <meta name="description" content="EdX Analytics Edge, Notes and Assignments" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Unit 8 Visualization | Analytics Edge - EdX" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="EdX Analytics Edge, Notes and Assignments" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Unit 8 Visualization | Analytics Edge - EdX" />
  
  <meta name="twitter:description" content="EdX Analytics Edge, Notes and Assignments" />
  

<meta name="author" content="omotoyosi Taiwo" />


<meta name="date" content="2019-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="clustering.html"/>
<link rel="next" href="final-exam.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Analytics Edge - EdX</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> EdX Analytics Edge Notebook</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#working-with-data"><i class="fa fa-check"></i><b>2.1</b> Working with data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#loading-data-files"><i class="fa fa-check"></i><b>2.1.1</b> Loading data files</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#summary-statistics"><i class="fa fa-check"></i><b>2.1.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction.html"><a href="introduction.html#plots"><i class="fa fa-check"></i><b>2.1.3</b> Plots</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction.html"><a href="introduction.html#summary-tables"><i class="fa fa-check"></i><b>2.1.4</b> Summary tables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#recitation---usda-food-database"><i class="fa fa-check"></i><b>2.2</b> Recitation - USDA Food Database</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#data-analysis---recitation"><i class="fa fa-check"></i><b>2.2.1</b> Data Analysis - Recitation</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#histogram---recitation"><i class="fa fa-check"></i><b>2.2.2</b> Histogram - Recitation</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction.html"><a href="introduction.html#summary-tables---recitation"><i class="fa fa-check"></i><b>2.2.3</b> Summary tables - Recitation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#assignment"><i class="fa fa-check"></i><b>2.3</b> Assignment</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#part-1---analytical-detective"><i class="fa fa-check"></i><b>2.3.1</b> Part 1 - Analytical Detective</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#part-2---stock-dynamics"><i class="fa fa-check"></i><b>2.3.2</b> Part 2 - Stock Dynamics</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction.html"><a href="introduction.html#part-3---demographics-and-employment-in-the-united-states"><i class="fa fa-check"></i><b>2.3.3</b> Part 3 - Demographics and Employment in the United States</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#introduction-to-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Introduction to Linear Regression</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#variable-linear-regression-model---predicting-wine-quality"><i class="fa fa-check"></i><b>3.1.1</b> 1 variable Linear Regression Model - Predicting Wine Quality</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression-model"><i class="fa fa-check"></i><b>3.1.2</b> Multiple Linear Regression Model</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#correlation-and-muticollinearity"><i class="fa fa-check"></i><b>3.1.3</b> Correlation and Muticollinearity</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-regression.html"><a href="linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>3.1.4</b> Making Predictions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#recitation-2---moneyball-in-the-nba"><i class="fa fa-check"></i><b>3.2</b> Recitation 2 - MOneyball in the NBA</a><ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#regression-model-using-more-than-just-wins-variable"><i class="fa fa-check"></i><b>3.2.1</b> Regression model using more than just Wins variable</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>3.2.2</b> Making Predictions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#assignment-1"><i class="fa fa-check"></i><b>3.3</b> Assignment</a><ul>
<li class="chapter" data-level="3.3.1" data-path="linear-regression.html"><a href="linear-regression.html#part-1---climate-change"><i class="fa fa-check"></i><b>3.3.1</b> Part 1 - Climate Change</a></li>
<li class="chapter" data-level="3.3.2" data-path="linear-regression.html"><a href="linear-regression.html#part-2---detecting-flu-epidemics"><i class="fa fa-check"></i><b>3.3.2</b> Part 2 - Detecting Flu Epidemics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>4</b> Logistic Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#introduction-to-logistic-regression"><i class="fa fa-check"></i><b>4.1</b> Introduction to Logistic Regression</a><ul>
<li class="chapter" data-level="4.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#thresholding"><i class="fa fa-check"></i><b>4.1.1</b> Thresholding</a></li>
<li class="chapter" data-level="4.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#roc-curves"><i class="fa fa-check"></i><b>4.1.2</b> ROC Curves</a></li>
<li class="chapter" data-level="4.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#making-predictions-2"><i class="fa fa-check"></i><b>4.1.3</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="logistic-regression.html"><a href="logistic-regression.html#framingham-heart-study"><i class="fa fa-check"></i><b>4.2</b> Framingham Heart study</a></li>
<li class="chapter" data-level="4.3" data-path="logistic-regression.html"><a href="logistic-regression.html#recitation-3---election-forecasting"><i class="fa fa-check"></i><b>4.3</b> Recitation 3 - Election Forecasting</a><ul>
<li class="chapter" data-level="4.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#a-sophisticated-baseline-model"><i class="fa fa-check"></i><b>4.3.1</b> A sophisticated baseline model</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="logistic-regression.html"><a href="logistic-regression.html#assignment-2"><i class="fa fa-check"></i><b>4.4</b> Assignment</a><ul>
<li class="chapter" data-level="4.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#part-1---popularity-of-music-records"><i class="fa fa-check"></i><b>4.4.1</b> Part 1 - Popularity of Music Records</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html"><i class="fa fa-check"></i><b>5</b> Classification and Regression Trees (CART)</a><ul>
<li class="chapter" data-level="5.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#introduction-to-trees---judge-jury-and-classifier"><i class="fa fa-check"></i><b>5.1</b> Introduction to trees - Judge, Jury, and Classifier</a><ul>
<li class="chapter" data-level="5.1.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#random-forests"><i class="fa fa-check"></i><b>5.1.1</b> Random Forests</a></li>
<li class="chapter" data-level="5.1.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#cross-validation"><i class="fa fa-check"></i><b>5.1.2</b> Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#the-d2hawkeye-story"><i class="fa fa-check"></i><b>5.2</b> The D2Hawkeye Story</a><ul>
<li class="chapter" data-level="5.2.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#baseline-method-and-penalty-matrix"><i class="fa fa-check"></i><b>5.2.1</b> Baseline method and Penalty Matrix</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#recitation---boston-housing-data-regression-trees"><i class="fa fa-check"></i><b>5.3</b> Recitation - Boston Housing Data (Regression Trees)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#geographical-predictions"><i class="fa fa-check"></i><b>5.3.1</b> Geographical Predictions</a></li>
<li class="chapter" data-level="5.3.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#cross-validation-1"><i class="fa fa-check"></i><b>5.3.2</b> Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#assignment-3"><i class="fa fa-check"></i><b>5.4</b> Assignment</a><ul>
<li class="chapter" data-level="5.4.1" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#part-1---understanding-why-people-vote"><i class="fa fa-check"></i><b>5.4.1</b> Part 1 - Understanding why people vote</a></li>
<li class="chapter" data-level="5.4.2" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#part-2---letter-recognition"><i class="fa fa-check"></i><b>5.4.2</b> Part 2 - Letter Recognition</a></li>
<li class="chapter" data-level="5.4.3" data-path="classification-and-regression-trees-cart.html"><a href="classification-and-regression-trees-cart.html#part-3---predicting-earnings-from-census-data"><i class="fa fa-check"></i><b>5.4.3</b> Part 3 - Predicting Earnings from Census Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="text-analytics.html"><a href="text-analytics.html"><i class="fa fa-check"></i><b>6</b> Text Analytics</a><ul>
<li class="chapter" data-level="6.1" data-path="text-analytics.html"><a href="text-analytics.html#introduction-to-text-analytics"><i class="fa fa-check"></i><b>6.1</b> Introduction to Text Analytics</a><ul>
<li class="chapter" data-level="6.1.1" data-path="text-analytics.html"><a href="text-analytics.html#turning-tweets-into-knowledge"><i class="fa fa-check"></i><b>6.1.1</b> Turning Tweets into knowledge</a></li>
<li class="chapter" data-level="6.1.2" data-path="text-analytics.html"><a href="text-analytics.html#preprocessing-data"><i class="fa fa-check"></i><b>6.1.2</b> Preprocessing data</a></li>
<li class="chapter" data-level="6.1.3" data-path="text-analytics.html"><a href="text-analytics.html#build-a-cart-model"><i class="fa fa-check"></i><b>6.1.3</b> Build a CART model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="text-analytics.html"><a href="text-analytics.html#recitation---the-story-of-enron"><i class="fa fa-check"></i><b>6.2</b> Recitation - The Story of Enron</a><ul>
<li class="chapter" data-level="6.2.1" data-path="text-analytics.html"><a href="text-analytics.html#bag-of-words"><i class="fa fa-check"></i><b>6.2.1</b> Bag of Words</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="text-analytics.html"><a href="text-analytics.html#assignment-4"><i class="fa fa-check"></i><b>6.3</b> Assignment</a><ul>
<li class="chapter" data-level="6.3.1" data-path="text-analytics.html"><a href="text-analytics.html#part-1---detecting-vandalism-on-wikipedia"><i class="fa fa-check"></i><b>6.3.1</b> Part 1 - Detecting Vandalism on Wikipedia</a></li>
<li class="chapter" data-level="6.3.2" data-path="text-analytics.html"><a href="text-analytics.html#part-2---automating-reviews-in-medicine"><i class="fa fa-check"></i><b>6.3.2</b> Part 2 - Automating Reviews in Medicine</a></li>
<li class="chapter" data-level="6.3.3" data-path="text-analytics.html"><a href="text-analytics.html#part-3---separating-spam-from-ham"><i class="fa fa-check"></i><b>6.3.3</b> Part 3 - Separating Spam from Ham</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>7</b> Clustering</a><ul>
<li class="chapter" data-level="7.1" data-path="clustering.html"><a href="clustering.html#introduction-to-clustering"><i class="fa fa-check"></i><b>7.1</b> Introduction to Clustering</a><ul>
<li class="chapter" data-level="7.1.1" data-path="clustering.html"><a href="clustering.html#heirarchical-clustering"><i class="fa fa-check"></i><b>7.1.1</b> Heirarchical Clustering</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="clustering.html"><a href="clustering.html#recitation---segmenting-images"><i class="fa fa-check"></i><b>7.2</b> Recitation - Segmenting Images</a><ul>
<li class="chapter" data-level="7.2.1" data-path="clustering.html"><a href="clustering.html#flower-image"><i class="fa fa-check"></i><b>7.2.1</b> Flower Image</a></li>
<li class="chapter" data-level="7.2.2" data-path="clustering.html"><a href="clustering.html#mri-image"><i class="fa fa-check"></i><b>7.2.2</b> MRI Image</a></li>
<li class="chapter" data-level="7.2.3" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>7.2.3</b> K-Means Clustering</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="clustering.html"><a href="clustering.html#assignment-5"><i class="fa fa-check"></i><b>7.3</b> Assignment</a><ul>
<li class="chapter" data-level="7.3.1" data-path="clustering.html"><a href="clustering.html#part-1---document-clustering-with-daily-kos"><i class="fa fa-check"></i><b>7.3.1</b> Part 1 - Document Clustering with Daily Kos</a></li>
<li class="chapter" data-level="7.3.2" data-path="clustering.html"><a href="clustering.html#part-2---market-segmentation-for-airlines"><i class="fa fa-check"></i><b>7.3.2</b> Part 2 - Market Segmentation for Airlines</a></li>
<li class="chapter" data-level="7.3.3" data-path="clustering.html"><a href="clustering.html#part-3---predicting-stock-returns-with-cluster-then-predict"><i class="fa fa-check"></i><b>7.3.3</b> Part 3 - Predicting Stock Returns with Cluster-Then-Predict</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>8</b> Visualization</a><ul>
<li class="chapter" data-level="8.1" data-path="visualization.html"><a href="visualization.html#scatterplots---visualizing-the-world"><i class="fa fa-check"></i><b>8.1</b> Scatterplots - Visualizing the world</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualization.html"><a href="visualization.html#basic-scatterplots-using-ggplot"><i class="fa fa-check"></i><b>8.1.1</b> Basic scatterplots using ggplot</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualization.html"><a href="visualization.html#visualizing-crime-over-time"><i class="fa fa-check"></i><b>8.2</b> Visualizing crime over time</a><ul>
<li class="chapter" data-level="8.2.1" data-path="visualization.html"><a href="visualization.html#heatmaps"><i class="fa fa-check"></i><b>8.2.1</b> Heatmaps</a></li>
<li class="chapter" data-level="8.2.2" data-path="visualization.html"><a href="visualization.html#a-geographical-hot-spot-map"><i class="fa fa-check"></i><b>8.2.2</b> A Geographical Hot Spot Map</a></li>
<li class="chapter" data-level="8.2.3" data-path="visualization.html"><a href="visualization.html#a-heatmap-of-the-united-states"><i class="fa fa-check"></i><b>8.2.3</b> A Heatmap of the United States</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visualization.html"><a href="visualization.html#recitation"><i class="fa fa-check"></i><b>8.3</b> Recitation</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualization.html"><a href="visualization.html#bar-charts"><i class="fa fa-check"></i><b>8.3.1</b> Bar Charts</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualization.html"><a href="visualization.html#assignment-6"><i class="fa fa-check"></i><b>8.4</b> Assignment</a><ul>
<li class="chapter" data-level="8.4.1" data-path="visualization.html"><a href="visualization.html#part-1---election-forecasting-revisited"><i class="fa fa-check"></i><b>8.4.1</b> Part 1 - Election Forecasting Revisited</a></li>
<li class="chapter" data-level="8.4.2" data-path="visualization.html"><a href="visualization.html#part-2---visualizing-network-data"><i class="fa fa-check"></i><b>8.4.2</b> Part 2 - Visualizing Network Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="final-exam.html"><a href="final-exam.html"><i class="fa fa-check"></i><b>9</b> Final Exam</a><ul>
<li class="chapter" data-level="9.1" data-path="final-exam.html"><a href="final-exam.html#part-1---estimating-miles-per-gallon"><i class="fa fa-check"></i><b>9.1</b> Part 1 - Estimating Miles Per Gallon</a><ul>
<li class="chapter" data-level="9.1.1" data-path="final-exam.html"><a href="final-exam.html#problem-1---exploratory-data-analysis"><i class="fa fa-check"></i><b>9.1.1</b> Problem 1 - Exploratory Data Analysis</a></li>
<li class="chapter" data-level="9.1.2" data-path="final-exam.html"><a href="final-exam.html#problem-2---simple-linear-regression"><i class="fa fa-check"></i><b>9.1.2</b> Problem 2 - Simple Linear Regression</a></li>
<li class="chapter" data-level="9.1.3" data-path="final-exam.html"><a href="final-exam.html#problem-3---adding-more-variables"><i class="fa fa-check"></i><b>9.1.3</b> Problem 3 - Adding More Variables</a></li>
<li class="chapter" data-level="9.1.4" data-path="final-exam.html"><a href="final-exam.html#problem-4---cart-and-randomforest"><i class="fa fa-check"></i><b>9.1.4</b> Problem 4 - CART and Randomforest</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="final-exam.html"><a href="final-exam.html#part-2---predicting-heart-disease"><i class="fa fa-check"></i><b>9.2</b> Part 2 - Predicting Heart Disease</a><ul>
<li class="chapter" data-level="9.2.1" data-path="final-exam.html"><a href="final-exam.html#problem-12---exploratory-data-analysis-and-logistic-regression"><i class="fa fa-check"></i><b>9.2.1</b> Problem 1&amp;2 - Exploratory Data Analysis and Logistic Regression</a></li>
<li class="chapter" data-level="9.2.2" data-path="final-exam.html"><a href="final-exam.html#problem-3---adding-more-variables-1"><i class="fa fa-check"></i><b>9.2.2</b> Problem 3 - Adding More Variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="final-exam.html"><a href="final-exam.html#problem-4---cart"><i class="fa fa-check"></i><b>9.2.3</b> Problem 4 - CART</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="final-exam.html"><a href="final-exam.html#part-3---understanding-users-spending"><i class="fa fa-check"></i><b>9.3</b> Part 3 - Understanding User’s Spending</a><ul>
<li class="chapter" data-level="9.3.1" data-path="final-exam.html"><a href="final-exam.html#problem-1-and-2"><i class="fa fa-check"></i><b>9.3.1</b> Problem 1 and 2</a></li>
<li class="chapter" data-level="9.3.2" data-path="final-exam.html"><a href="final-exam.html#problem-3---clustering"><i class="fa fa-check"></i><b>9.3.2</b> Problem 3 - Clustering</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analytics Edge - EdX</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1">
<h1><span class="header-section-number">Unit 8</span> Visualization</h1>
<div id="scatterplots---visualizing-the-world" class="section level2">
<h2><span class="header-section-number">8.1</span> Scatterplots - Visualizing the world</h2>
<div id="basic-scatterplots-using-ggplot" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Basic scatterplots using ggplot</h3>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" title="1"><span class="co"># Read in data</span></a>
<a class="sourceLine" id="cb709-2" title="2">WHO &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/WHO.csv&quot;</span>)</a>
<a class="sourceLine" id="cb709-3" title="3"><span class="kw">str</span>(WHO)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    194 obs. of  13 variables:
##  $ Country                      : Factor w/ 194 levels &quot;Afghanistan&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Region                       : Factor w/ 6 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 4 1 4 1 2 2 4 6 4 ...
##  $ Population                   : int  29825 3162 38482 78 20821 89 41087 2969 23050 8464 ...
##  $ Under15                      : num  47.4 21.3 27.4 15.2 47.6 ...
##  $ Over60                       : num  3.82 14.93 7.17 22.86 3.84 ...
##  $ FertilityRate                : num  5.4 1.75 2.83 NA 6.1 2.12 2.2 1.74 1.89 1.44 ...
##  $ LifeExpectancy               : int  60 74 73 82 51 75 76 71 82 81 ...
##  $ ChildMortality               : num  98.5 16.7 20 3.2 163.5 ...
##  $ CellularSubscribers          : num  54.3 96.4 99 75.5 48.4 ...
...</code></pre>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb711-2" title="2"><span class="co"># Create the ggplot object with the data and the aesthetic mapping:</span></a>
<a class="sourceLine" id="cb711-3" title="3">scatterplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> GNI, <span class="dt">y =</span> FertilityRate))</a>
<a class="sourceLine" id="cb711-4" title="4"><span class="co"># Add the geom_point geometry</span></a>
<a class="sourceLine" id="cb711-5" title="5">scatterplot <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" title="1"><span class="co"># Redo the plot with blue triangles instead of circles:</span></a>
<a class="sourceLine" id="cb713-2" title="2">scatterplot <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">17</span>) </a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-2.png" width="672" /></p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1">scatterplot <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">8</span>) </a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-3.png" width="672" /></p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" title="1"><span class="co"># Add a title to the plot:</span></a>
<a class="sourceLine" id="cb717-2" title="2">scatterplot <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">17</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Fertility Rate vs. Gross National Income&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-4.png" width="672" /></p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1"><span class="co"># Color the points by region: </span></a>
<a class="sourceLine" id="cb719-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> GNI, <span class="dt">y =</span> FertilityRate, <span class="dt">color =</span> Region)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-5.png" width="672" /></p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1"><span class="co"># Color the points according to life expectancy:</span></a>
<a class="sourceLine" id="cb721-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> GNI, <span class="dt">y =</span> FertilityRate, <span class="dt">color =</span> LifeExpectancy)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-6.png" width="672" /></p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1"><span class="co"># Is the fertility rate of a country was a good predictor of the percentage of the population under 15?</span></a>
<a class="sourceLine" id="cb723-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> FertilityRate, <span class="dt">y =</span> Under15)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-7.png" width="672" /></p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" title="1"><span class="co"># Let&#39;s try a log transformation:</span></a>
<a class="sourceLine" id="cb725-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(FertilityRate), <span class="dt">y =</span> Under15)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-8.png" width="672" /></p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb727-1" title="1"><span class="co"># Simple linear regression model to predict the percentage of the population under 15, using the log of the fertility rate:</span></a>
<a class="sourceLine" id="cb727-2" title="2">mod =<span class="st"> </span><span class="kw">lm</span>(Under15 <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(FertilityRate), <span class="dt">data =</span> WHO)</a>
<a class="sourceLine" id="cb727-3" title="3"><span class="kw">summary</span>(mod)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Under15 ~ log(FertilityRate), data = WHO)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.3131  -1.7742   0.0446   1.7440   7.7174 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
...</code></pre>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" title="1"><span class="co"># Add this regression line to our plot:</span></a>
<a class="sourceLine" id="cb729-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(FertilityRate), <span class="dt">y =</span> Under15)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-9.png" width="672" /></p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb732-1" title="1"><span class="co"># 99% confidence interval</span></a>
<a class="sourceLine" id="cb732-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(FertilityRate), <span class="dt">y =</span> Under15)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">level =</span> <span class="fl">0.99</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_smooth).

## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-10.png" width="672" /></p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb734-1" title="1"><span class="co"># No confidence interval in the plot</span></a>
<a class="sourceLine" id="cb734-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(FertilityRate), <span class="dt">y =</span> Under15)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_smooth).

## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-11.png" width="672" /></p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb736-1" title="1"><span class="co"># Change the color of the regression line:</span></a>
<a class="sourceLine" id="cb736-2" title="2"><span class="kw">ggplot</span>(WHO, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(FertilityRate), <span class="dt">y =</span> Under15)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;orange&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite values (stat_smooth).

## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-112-12.png" width="672" /></p>
</div>
</div>
<div id="visualizing-crime-over-time" class="section level2">
<h2><span class="header-section-number">8.2</span> Visualizing crime over time</h2>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb738-1" title="1">mvt &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/mvt.csv&quot;</span>)</a>
<a class="sourceLine" id="cb738-2" title="2"><span class="co"># Convert the Date variable to a format that R will recognize:</span></a>
<a class="sourceLine" id="cb738-3" title="3">mvt<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">strptime</span>(mvt<span class="op">$</span>Date, <span class="dt">format=</span><span class="st">&quot;%m/%d/%y %H:%M&quot;</span>)</a>
<a class="sourceLine" id="cb738-4" title="4"><span class="co"># Extract the hour and the day of the week:</span></a>
<a class="sourceLine" id="cb738-5" title="5">mvt<span class="op">$</span>Weekday &lt;-<span class="st"> </span><span class="kw">weekdays</span>(mvt<span class="op">$</span>Date)</a>
<a class="sourceLine" id="cb738-6" title="6">mvt<span class="op">$</span>Hour &lt;-<span class="st"> </span>mvt<span class="op">$</span>Date<span class="op">$</span>hour</a>
<a class="sourceLine" id="cb738-7" title="7"></a>
<a class="sourceLine" id="cb738-8" title="8"><span class="co"># Create a simple line plot - need the total number of crimes on each day of the week. We can get this information by creating a table:</span></a>
<a class="sourceLine" id="cb738-9" title="9"><span class="kw">table</span>(mvt<span class="op">$</span>Weekday)</a></code></pre></div>
<pre><code>## 
##    Friday    Monday  Saturday    Sunday  Thursday   Tuesday Wednesday 
##     29284     27397     27118     26316     27319     26791     27416</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb740-1" title="1"><span class="co"># Save this table as a data frame:</span></a>
<a class="sourceLine" id="cb740-2" title="2">WeekdayCounts &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(mvt<span class="op">$</span>Weekday))</a>
<a class="sourceLine" id="cb740-3" title="3"><span class="kw">str</span>(WeekdayCounts) </a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    7 obs. of  2 variables:
##  $ Var1: Factor w/ 7 levels &quot;Friday&quot;,&quot;Monday&quot;,..: 1 2 3 4 5 6 7
##  $ Freq: int  29284 27397 27118 26316 27319 26791 27416</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb742-1" title="1"><span class="co"># Create our plot</span></a>
<a class="sourceLine" id="cb742-2" title="2"><span class="kw">ggplot</span>(WeekdayCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" title="1"><span class="co"># Make the &quot;Var1&quot; variable an ORDERED factor variable</span></a>
<a class="sourceLine" id="cb743-2" title="2">WeekdayCounts<span class="op">$</span>Var1 &lt;-<span class="st"> </span><span class="kw">factor</span>(WeekdayCounts<span class="op">$</span>Var1, <span class="dt">ordered=</span><span class="ot">TRUE</span>, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>, <span class="st">&quot;Wednesday&quot;</span>, <span class="st">&quot;Thursday&quot;</span>, <span class="st">&quot;Friday&quot;</span>,<span class="st">&quot;Saturday&quot;</span>))</a>
<a class="sourceLine" id="cb743-3" title="3"><span class="co"># Try again:</span></a>
<a class="sourceLine" id="cb743-4" title="4"><span class="kw">ggplot</span>(WeekdayCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-113-2.png" width="672" /></p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb744-1" title="1"><span class="co"># Change our x and y labels:</span></a>
<a class="sourceLine" id="cb744-2" title="2"><span class="kw">ggplot</span>(WeekdayCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Var1, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Day of the Week&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Total Motor Vehicle Thefts&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-113-3.png" width="672" /></p>
<div id="heatmaps" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Heatmaps</h3>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" title="1"><span class="co"># Create a counts table for the weekday and hour:</span></a>
<a class="sourceLine" id="cb745-2" title="2"><span class="kw">table</span>(mvt<span class="op">$</span>Weekday, mvt<span class="op">$</span>Hour)</a></code></pre></div>
<pre><code>##            
##                0    1    2    3    4    5    6    7    8    9   10   11   12
##   Friday    1873  932  743  560  473  602  839 1203 1268 1286  938  822 1207
##   Monday    1900  825  712  527  415  542  772 1123 1323 1235  971  737 1129
##   Saturday  2050 1267  985  836  652  508  541  650  858 1039  946  789 1204
##   Sunday    2028 1236 1019  838  607  461  478  483  615  864  884  787 1192
##   Thursday  1856  816  696  508  400  534  799 1135 1298 1301  932  731 1093
##   Tuesday   1691  777  603  464  414  520  845 1118 1175 1174  948  786 1108
##   Wednesday 1814  790  619  469  396  561  862 1140 1329 1237  947  763 1225
##            
...</code></pre>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" title="1"><span class="co"># Save this to a data frame:</span></a>
<a class="sourceLine" id="cb747-2" title="2">DayHourCounts &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(mvt<span class="op">$</span>Weekday, mvt<span class="op">$</span>Hour))</a>
<a class="sourceLine" id="cb747-3" title="3"><span class="kw">str</span>(DayHourCounts)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    168 obs. of  3 variables:
##  $ Var1: Factor w/ 7 levels &quot;Friday&quot;,&quot;Monday&quot;,..: 1 2 3 4 5 6 7 1 2 3 ...
##  $ Var2: Factor w/ 24 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 1 1 1 1 1 1 1 2 2 2 ...
##  $ Freq: int  1873 1900 2050 2028 1856 1691 1814 932 825 1267 ...</code></pre>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" title="1"><span class="co"># Convert the second variable, Var2, to numbers and call it Hour:</span></a>
<a class="sourceLine" id="cb749-2" title="2">DayHourCounts<span class="op">$</span>Hour &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(DayHourCounts<span class="op">$</span>Var2))</a>
<a class="sourceLine" id="cb749-3" title="3"></a>
<a class="sourceLine" id="cb749-4" title="4"><span class="co"># Create out plot:</span></a>
<a class="sourceLine" id="cb749-5" title="5"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Hour, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>Var1))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb750-1" title="1"><span class="co"># Change the colors</span></a>
<a class="sourceLine" id="cb750-2" title="2"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Hour, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>Var1, <span class="dt">color=</span>Var1), <span class="dt">size=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-2.png" width="672" /></p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" title="1"><span class="co"># Separate the weekends from the weekdays:</span></a>
<a class="sourceLine" id="cb751-2" title="2">DayHourCounts<span class="op">$</span>Type =<span class="st"> </span><span class="kw">ifelse</span>((DayHourCounts<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> &quot;Sunday&quot;</span>) <span class="op">|</span><span class="st"> </span>(DayHourCounts<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> &quot;Saturday&quot;</span>), <span class="st">&quot;Weekend&quot;</span>, <span class="st">&quot;Weekday&quot;</span>)</a>
<a class="sourceLine" id="cb751-3" title="3"></a>
<a class="sourceLine" id="cb751-4" title="4"><span class="co"># Redo our plot, this time coloring by Type:</span></a>
<a class="sourceLine" id="cb751-5" title="5"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Hour, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>Var1, <span class="dt">color=</span>Type), <span class="dt">size=</span><span class="dv">2</span>) </a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-3.png" width="672" /></p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb752-1" title="1"><span class="co"># Make the lines a little transparent:</span></a>
<a class="sourceLine" id="cb752-2" title="2"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x=</span>Hour, <span class="dt">y=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>Var1, <span class="dt">color=</span>Type), <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) </a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-4.png" width="672" /></p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" title="1"><span class="co"># Fix the order of the days:</span></a>
<a class="sourceLine" id="cb753-2" title="2">DayHourCounts<span class="op">$</span>Var1 =<span class="st"> </span><span class="kw">factor</span>(DayHourCounts<span class="op">$</span>Var1, <span class="dt">ordered=</span><span class="ot">TRUE</span>, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>, <span class="st">&quot;Wednesday&quot;</span>, <span class="st">&quot;Thursday&quot;</span>, <span class="st">&quot;Friday&quot;</span>, <span class="st">&quot;Saturday&quot;</span>, <span class="st">&quot;Sunday&quot;</span>))</a>
<a class="sourceLine" id="cb753-3" title="3"><span class="co"># Make a heatmap:</span></a>
<a class="sourceLine" id="cb753-4" title="4"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x =</span> Hour, <span class="dt">y =</span> Var1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Freq))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-5.png" width="672" /></p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb754-1" title="1"><span class="co"># Change the label on the legend, and get rid of the y-label:</span></a>
<a class="sourceLine" id="cb754-2" title="2"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x =</span> Hour, <span class="dt">y =</span> Var1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">name=</span><span class="st">&quot;Total MV Thefts&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-6.png" width="672" /></p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" title="1"><span class="co"># Change the color scheme</span></a>
<a class="sourceLine" id="cb755-2" title="2"><span class="kw">ggplot</span>(DayHourCounts, <span class="kw">aes</span>(<span class="dt">x =</span> Hour, <span class="dt">y =</span> Var1)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">name=</span><span class="st">&quot;Total MV Thefts&quot;</span>, <span class="dt">low=</span><span class="st">&quot;white&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-114-7.png" width="672" /></p>
</div>
<div id="a-geographical-hot-spot-map" class="section level3">
<h3><span class="header-section-number">8.2.2</span> A Geographical Hot Spot Map</h3>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb756-1" title="1"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb756-2" title="2"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb756-3" title="3"><span class="kw">library</span>(tmaptools)</a>
<a class="sourceLine" id="cb756-4" title="4"></a>
<a class="sourceLine" id="cb756-5" title="5"><span class="co"># Load a map of Chicago into R:</span></a>
<a class="sourceLine" id="cb756-6" title="6">chicago &lt;-<span class="st"> </span><span class="kw">get_stamenmap</span>(<span class="kw">rbind</span>(<span class="kw">as.numeric</span>(<span class="kw">paste</span>(<span class="kw">geocode_OSM</span>(<span class="st">&quot;Chicago&quot;</span>)<span class="op">$</span>bbox))), <span class="dt">zoom =</span> <span class="dv">11</span>)</a></code></pre></div>
<pre><code>## Source : http://tile.stamen.com/terrain/11/523/760.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/524/760.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/525/760.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/526/760.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/523/761.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/524/761.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/525/761.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/526/761.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/523/762.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/524/762.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/525/762.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/11/526/762.png</code></pre>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb769-1" title="1"><span class="co"># Look at the map</span></a>
<a class="sourceLine" id="cb769-2" title="2"><span class="kw">ggmap</span>(chicago)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb770-1" title="1"><span class="co"># Plot the first 100 motor vehicle thefts:</span></a>
<a class="sourceLine" id="cb770-2" title="2"><span class="kw">ggmap</span>(chicago) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mvt[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,], <span class="kw">aes</span>(<span class="dt">x =</span> Longitude, <span class="dt">y =</span> Latitude))</a></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-115-2.png" width="672" /></p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb772-1" title="1"><span class="co"># Round our latitude and longitude to 2 digits of accuracy, and create a crime counts data frame for each area:</span></a>
<a class="sourceLine" id="cb772-2" title="2">LatLonCounts &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(<span class="kw">round</span>(mvt<span class="op">$</span>Longitude,<span class="dv">2</span>), <span class="kw">round</span>(mvt<span class="op">$</span>Latitude,<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb772-3" title="3"><span class="kw">str</span>(LatLonCounts)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1638 obs. of  3 variables:
##  $ Var1: Factor w/ 42 levels &quot;-87.93&quot;,&quot;-87.92&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 39 levels &quot;41.64&quot;,&quot;41.65&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Freq: int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb774-1" title="1"><span class="co"># Convert our Longitude and Latitude variable to numbers:</span></a>
<a class="sourceLine" id="cb774-2" title="2">LatLonCounts<span class="op">$</span>Long &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(LatLonCounts<span class="op">$</span>Var1))</a>
<a class="sourceLine" id="cb774-3" title="3">LatLonCounts<span class="op">$</span>Lat &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(LatLonCounts<span class="op">$</span>Var2))</a>
<a class="sourceLine" id="cb774-4" title="4"><span class="co"># Plot these points on our map:</span></a>
<a class="sourceLine" id="cb774-5" title="5"><span class="kw">ggmap</span>(chicago) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> LatLonCounts, <span class="kw">aes</span>(<span class="dt">x =</span> Long, <span class="dt">y =</span> Lat, <span class="dt">color =</span> Freq, <span class="dt">size=</span>Freq))</a></code></pre></div>
<pre><code>## Warning: Removed 80 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-115-3.png" width="672" /></p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb776-1" title="1"><span class="co"># Change the color scheme:</span></a>
<a class="sourceLine" id="cb776-2" title="2"><span class="kw">ggmap</span>(chicago) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> LatLonCounts, <span class="kw">aes</span>(<span class="dt">x =</span> Long, <span class="dt">y =</span> Lat, <span class="dt">color =</span> Freq, <span class="dt">size=</span>Freq)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_gradient</span>(<span class="dt">low=</span><span class="st">&quot;yellow&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 80 rows containing missing values (geom_point).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-115-4.png" width="672" /></p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb778-1" title="1"><span class="co"># We can also use the geom_tile geometry</span></a>
<a class="sourceLine" id="cb778-2" title="2"><span class="kw">ggmap</span>(chicago) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="dt">data =</span> LatLonCounts, <span class="kw">aes</span>(<span class="dt">x =</span> Long, <span class="dt">y =</span> Lat, <span class="dt">alpha =</span> Freq), <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 80 rows containing missing values (geom_tile).</code></pre>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-115-5.png" width="672" /></p>
</div>
<div id="a-heatmap-of-the-united-states" class="section level3">
<h3><span class="header-section-number">8.2.3</span> A Heatmap of the United States</h3>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb780-1" title="1">murders &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/murders.csv&quot;</span>)</a>
<a class="sourceLine" id="cb780-2" title="2"><span class="kw">str</span>(murders)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    51 obs. of  6 variables:
##  $ State            : Factor w/ 51 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Population       : int  4779736 710231 6392017 2915918 37253956 5029196 3574097 897934 601723 19687653 ...
##  $ PopulationDensity: num  94.65 1.26 57.05 56.43 244.2 ...
##  $ Murders          : int  199 31 352 130 1811 117 131 48 131 987 ...
##  $ GunMurders       : int  135 19 232 93 1257 65 97 38 99 669 ...
##  $ GunOwnership     : num  0.517 0.578 0.311 0.553 0.213 0.347 0.167 0.255 0.036 0.245 ...</code></pre>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb782-1" title="1"><span class="co"># Load the map of the US</span></a>
<a class="sourceLine" id="cb782-2" title="2">statesMap &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)</a>
<a class="sourceLine" id="cb782-3" title="3"><span class="kw">str</span>(statesMap)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    15537 obs. of  6 variables:
##  $ long     : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
##  $ lat      : num  30.4 30.4 30.4 30.3 30.3 ...
##  $ group    : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ order    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ region   : chr  &quot;alabama&quot; &quot;alabama&quot; &quot;alabama&quot; &quot;alabama&quot; ...
##  $ subregion: chr  NA NA NA NA ...</code></pre>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb784-1" title="1"><span class="co"># Plot the map:</span></a>
<a class="sourceLine" id="cb784-2" title="2"><span class="kw">ggplot</span>(statesMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) </a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb785-1" title="1"><span class="co"># Create a new variable called region with the lowercase names to match the statesMap:</span></a>
<a class="sourceLine" id="cb785-2" title="2">murders<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">tolower</span>(murders<span class="op">$</span>State)</a>
<a class="sourceLine" id="cb785-3" title="3"><span class="co"># Join the statesMap data and the murders data into one dataframe:</span></a>
<a class="sourceLine" id="cb785-4" title="4">murderMap &lt;-<span class="st"> </span><span class="kw">merge</span>(statesMap, murders, <span class="dt">by=</span><span class="st">&quot;region&quot;</span>)</a>
<a class="sourceLine" id="cb785-5" title="5"><span class="kw">str</span>(murderMap)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    15537 obs. of  12 variables:
##  $ region           : chr  &quot;alabama&quot; &quot;alabama&quot; &quot;alabama&quot; &quot;alabama&quot; ...
##  $ long             : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
##  $ lat              : num  30.4 30.4 30.4 30.3 30.3 ...
##  $ group            : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ order            : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ subregion        : chr  NA NA NA NA ...
##  $ State            : Factor w/ 51 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Population       : int  4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 4779736 ...
##  $ PopulationDensity: num  94.7 94.7 94.7 94.7 94.7 ...
...</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb787-1" title="1"><span class="co"># Plot the number of murder on our map of the United States:</span></a>
<a class="sourceLine" id="cb787-2" title="2"><span class="kw">ggplot</span>(murderMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> Murders)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-116-2.png" width="672" /></p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb788-1" title="1"><span class="co"># Plot a map of the population:</span></a>
<a class="sourceLine" id="cb788-2" title="2"><span class="kw">ggplot</span>(murderMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> Population)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-116-3.png" width="672" /></p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb789-1" title="1"><span class="co"># Create a new variable that is the number of murders per 100,000 population:</span></a>
<a class="sourceLine" id="cb789-2" title="2">murderMap<span class="op">$</span>MurderRate &lt;-<span class="st"> </span>murderMap<span class="op">$</span>Murders <span class="op">/</span><span class="st"> </span>murderMap<span class="op">$</span>Population <span class="op">*</span><span class="st"> </span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb789-3" title="3"></a>
<a class="sourceLine" id="cb789-4" title="4"><span class="co"># Redo our plot with murder rate:</span></a>
<a class="sourceLine" id="cb789-5" title="5"><span class="kw">ggplot</span>(murderMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> MurderRate)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-116-4.png" width="672" /></p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb790-1" title="1"><span class="co"># Redo the plot, removing any states with murder rates above 10:</span></a>
<a class="sourceLine" id="cb790-2" title="2"><span class="kw">ggplot</span>(murderMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> MurderRate)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-116-5.png" width="672" /></p>
</div>
</div>
<div id="recitation" class="section level2">
<h2><span class="header-section-number">8.3</span> Recitation</h2>
<div id="bar-charts" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Bar Charts</h3>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb791-1" title="1">intl &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/intl.csv&quot;</span>)</a>
<a class="sourceLine" id="cb791-2" title="2"><span class="kw">str</span>(intl)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    8 obs. of  2 variables:
##  $ Region       : Factor w/ 8 levels &quot;Africa&quot;,&quot;Asia&quot;,..: 2 3 6 4 5 1 7 8
##  $ PercentOfIntl: num  0.531 0.201 0.098 0.09 0.054 0.02 0.015 0.002</code></pre>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb793-1" title="1"><span class="co"># We want to make a bar plot with region on the X axis</span></a>
<a class="sourceLine" id="cb793-2" title="2"><span class="co"># and Percentage on the y-axis.</span></a>
<a class="sourceLine" id="cb793-3" title="3"><span class="kw">ggplot</span>(intl, <span class="kw">aes</span>(<span class="dt">x=</span>Region, <span class="dt">y=</span>PercentOfIntl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb793-4" title="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#</span></a>
<a class="sourceLine" id="cb793-5" title="5"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>PercentOfIntl))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb794-1" title="1"><span class="co">#Make region ordered by decreasing percentage</span></a>
<a class="sourceLine" id="cb794-2" title="2">intl &lt;-<span class="st"> </span><span class="kw">transform</span>(intl, <span class="dt">Region =</span> <span class="kw">reorder</span>(Region, <span class="op">-</span>PercentOfIntl))</a>
<a class="sourceLine" id="cb794-3" title="3">intl<span class="op">$</span>PercentOfIntl =<span class="st"> </span>intl<span class="op">$</span>PercentOfIntl <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="co">#normalize</span></a>
<a class="sourceLine" id="cb794-4" title="4"><span class="co"># Make the plot</span></a>
<a class="sourceLine" id="cb794-5" title="5"><span class="kw">ggplot</span>(intl, <span class="kw">aes</span>(<span class="dt">x=</span>Region, <span class="dt">y=</span>PercentOfIntl)) <span class="op">+</span></a>
<a class="sourceLine" id="cb794-6" title="6"><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;dark blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb794-7" title="7"><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>PercentOfIntl), <span class="dt">vjust=</span><span class="op">-</span><span class="fl">0.4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb794-8" title="8"><span class="kw">ylab</span>(<span class="st">&quot;Percent of International Students&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb794-9" title="9"><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-2.png" width="672" /></p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb795-1" title="1"><span class="co">#World Map</span></a>
<a class="sourceLine" id="cb795-2" title="2">intlall &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/intlall.csv&quot;</span>,<span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb795-3" title="3">intlall[<span class="kw">is.na</span>(intlall)] =<span class="st"> </span><span class="dv">0</span><span class="co">#replace NAs with 0</span></a>
<a class="sourceLine" id="cb795-4" title="4">world_map &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;world&quot;</span>)</a>
<a class="sourceLine" id="cb795-5" title="5"><span class="kw">str</span>(world_map)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    99338 obs. of  6 variables:
##  $ long     : num  -69.9 -69.9 -69.9 -70 -70.1 ...
##  $ lat      : num  12.5 12.4 12.4 12.5 12.5 ...
##  $ group    : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ order    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ region   : chr  &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; ...
##  $ subregion: chr  NA NA NA NA ...</code></pre>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb797-1" title="1"><span class="co">#Merge data by region on worldmap and citizenship on intlall</span></a>
<a class="sourceLine" id="cb797-2" title="2">world_map &lt;-<span class="st"> </span><span class="kw">merge</span>(world_map, intlall, <span class="dt">by.x =</span><span class="st">&quot;region&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;Citizenship&quot;</span>)</a>
<a class="sourceLine" id="cb797-3" title="3"><span class="kw">str</span>(world_map)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    63634 obs. of  12 variables:
##  $ region         : chr  &quot;Albania&quot; &quot;Albania&quot; &quot;Albania&quot; &quot;Albania&quot; ...
##  $ long           : num  20.5 20.4 19.5 20.5 20.4 ...
##  $ lat            : num  41.3 39.8 42.5 40.1 41.5 ...
##  $ group          : num  6 6 6 6 6 6 6 6 6 6 ...
##  $ order          : int  789 822 870 815 786 821 818 779 879 795 ...
##  $ subregion      : chr  NA NA NA NA ...
##  $ UG             : num  3 3 3 3 3 3 3 3 3 3 ...
##  $ G              : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ SpecialUG      : num  0 0 0 0 0 0 0 0 0 0 ...
...</code></pre>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb799-1" title="1"><span class="kw">ggplot</span>(world_map, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb799-2" title="2"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb799-3" title="3"><span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;mercator&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-3.png" width="672" /></p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb800-1" title="1"><span class="co"># Reorder the data</span></a>
<a class="sourceLine" id="cb800-2" title="2">world_map &lt;-<span class="st"> </span>world_map[<span class="kw">order</span>(world_map<span class="op">$</span>group, world_map<span class="op">$</span>order),]</a>
<a class="sourceLine" id="cb800-3" title="3"></a>
<a class="sourceLine" id="cb800-4" title="4"><span class="co"># Redo the plot</span></a>
<a class="sourceLine" id="cb800-5" title="5"><span class="kw">ggplot</span>(world_map, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb800-6" title="6"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb800-7" title="7"><span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;mercator&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-4.png" width="672" /></p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb801-1" title="1">intlall<span class="op">$</span>Citizenship[intlall<span class="op">$</span>Citizenship<span class="op">==</span><span class="st">&quot;China (People&#39;s Republic Of)&quot;</span>] &lt;-<span class="st"> &quot;China&quot;</span> <span class="co">#Fix China Name.</span></a>
<a class="sourceLine" id="cb801-2" title="2"><span class="co">#Remerge and order</span></a>
<a class="sourceLine" id="cb801-3" title="3">world_map &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="kw">map_data</span>(<span class="st">&quot;world&quot;</span>), intlall, </a>
<a class="sourceLine" id="cb801-4" title="4">                  <span class="dt">by.x =</span><span class="st">&quot;region&quot;</span>,</a>
<a class="sourceLine" id="cb801-5" title="5">                  <span class="dt">by.y =</span> <span class="st">&quot;Citizenship&quot;</span>)</a>
<a class="sourceLine" id="cb801-6" title="6">world_map &lt;-<span class="st"> </span>world_map[<span class="kw">order</span>(world_map<span class="op">$</span>group, world_map<span class="op">$</span>order),]</a>
<a class="sourceLine" id="cb801-7" title="7"></a>
<a class="sourceLine" id="cb801-8" title="8"><span class="kw">ggplot</span>(world_map, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-9" title="9"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Total), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb801-10" title="10"><span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;mercator&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">180</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-5.png" width="672" /></p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb802-1" title="1"><span class="co">#Other Projections</span></a>
<a class="sourceLine" id="cb802-2" title="2"><span class="kw">ggplot</span>(world_map, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb802-3" title="3"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Total), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb802-4" title="4"><span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;ortho&quot;</span>, <span class="dt">orientation=</span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">0</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-6.png" width="672" /></p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb803-1" title="1"><span class="kw">ggplot</span>(world_map, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">group=</span>group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb803-2" title="2"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Total), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb803-3" title="3"><span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;ortho&quot;</span>, <span class="dt">orientation=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">37</span>, <span class="dv">175</span>, <span class="dv">0</span>))</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-117-7.png" width="672" />
### Line Charts</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb804-1" title="1"><span class="co">#Using Line Charts</span></a>
<a class="sourceLine" id="cb804-2" title="2">households &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/households.csv&quot;</span>)</a>
<a class="sourceLine" id="cb804-3" title="3"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb804-4" title="4">households[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]<span class="co">#First 2 columns</span></a></code></pre></div>
<pre><code>##   Year MarriedWChild
## 1 1970          40.3
## 2 1980          30.9
## 3 1990          26.3
## 4 1995          25.5
## 5 2000          24.1
## 6 2005          22.9
## 7 2010          20.9
## 8 2012          19.6</code></pre>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb806-1" title="1"><span class="kw">head</span>(<span class="kw">melt</span>(households, <span class="dt">id=</span><span class="st">&quot;Year&quot;</span>))</a></code></pre></div>
<pre><code>##   Year      variable value
## 1 1970 MarriedWChild  40.3
## 2 1980 MarriedWChild  30.9
## 3 1990 MarriedWChild  26.3
## 4 1995 MarriedWChild  25.5
## 5 2000 MarriedWChild  24.1
## 6 2005 MarriedWChild  22.9</code></pre>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb808-1" title="1"><span class="kw">melt</span>(households, <span class="dt">id=</span><span class="st">&quot;Year&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>]</a></code></pre></div>
<pre><code>##  [1] 40.3 30.9 26.3 25.5 24.1 22.9 20.9 19.6 30.3 29.9</code></pre>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb810-1" title="1"><span class="kw">melt</span>(households, <span class="dt">id=</span><span class="st">&quot;Year&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</a></code></pre></div>
<pre><code>##    Year       variable value
## 1  1970  MarriedWChild  40.3
## 2  1980  MarriedWChild  30.9
## 3  1990  MarriedWChild  26.3
## 4  1995  MarriedWChild  25.5
## 5  2000  MarriedWChild  24.1
## 6  2005  MarriedWChild  22.9
## 7  2010  MarriedWChild  20.9
## 8  2012  MarriedWChild  19.6
## 9  1970 MarriedWOChild  30.3
...</code></pre>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb812-1" title="1"><span class="kw">ggplot</span>(<span class="kw">melt</span>(households, <span class="dt">id=</span><span class="st">&quot;Year&quot;</span>),       </a>
<a class="sourceLine" id="cb812-2" title="2">       <span class="kw">aes</span>(<span class="dt">x=</span>Year, <span class="dt">y=</span>value, <span class="dt">color=</span>variable)) <span class="op">+</span></a>
<a class="sourceLine" id="cb812-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb812-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Percentage of Households&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
</div>
</div>
<div id="assignment-6" class="section level2">
<h2><span class="header-section-number">8.4</span> Assignment</h2>
<div id="part-1---election-forecasting-revisited" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Part 1 - Election Forecasting Revisited</h3>
<div id="problem-1---drawing-a-map-of-the-us" class="section level4">
<h4><span class="header-section-number">8.4.1.1</span> Problem 1 - Drawing a Map of the US</h4>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb813-1" title="1"><span class="kw">library</span>(caTools)</a>
<a class="sourceLine" id="cb813-2" title="2"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb813-3" title="3"><span class="kw">library</span>(rpart.plot)</a>
<a class="sourceLine" id="cb813-4" title="4"><span class="kw">library</span>(ROCR)</a>
<a class="sourceLine" id="cb813-5" title="5"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb813-6" title="6"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb813-7" title="7"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb813-8" title="8"><span class="kw">library</span>(tmaptools)</a>
<a class="sourceLine" id="cb813-9" title="9"><span class="kw">library</span>(mapproj)</a>
<a class="sourceLine" id="cb813-10" title="10"><span class="co">#1.1 How many different groups are there? </span></a>
<a class="sourceLine" id="cb813-11" title="11">statesMap &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)</a>
<a class="sourceLine" id="cb813-12" title="12"><span class="kw">str</span>(statesMap)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    15537 obs. of  6 variables:
##  $ long     : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
##  $ lat      : num  30.4 30.4 30.4 30.3 30.3 ...
##  $ group    : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ order    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ region   : chr  &quot;alabama&quot; &quot;alabama&quot; &quot;alabama&quot; &quot;alabama&quot; ...
##  $ subregion: chr  NA NA NA NA ...</code></pre>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb815-1" title="1"><span class="kw">table</span>(statesMap<span class="op">$</span>group) <span class="co">#Ans - 63</span></a></code></pre></div>
<pre><code>## 
##    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
##  202  149  312  516   79   91   94   10  872  381  233  329  257  256  113  397 
##   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32 
##  650  399  566   36  220   30  460  370  373  382  315  238  208   70  125  205 
##   33   34   35   36   37   38   39   40   41   42   43   44   45   46   47   48 
##   78   16  290   21  168   37  733   12  105  238  284  236  172   66  304  166 
##   49   50   51   52   53   54   55   56   57   58   59   60   61   62   63 
##  289 1088   59  129   96   15  623   17   17   19   44  448  373  388   68</code></pre>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb817-1" title="1"><span class="co">#1.2</span></a>
<a class="sourceLine" id="cb817-2" title="2"><span class="kw">ggplot</span>(statesMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb817-3" title="3"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) </a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
<div id="problem-2---coloring-the-states-by-predictions" class="section level4">
<h4><span class="header-section-number">8.4.1.2</span> Problem 2 - Coloring the States by Predictions</h4>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb818-1" title="1"><span class="co">#2.1</span></a>
<a class="sourceLine" id="cb818-2" title="2">polling &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/PollingImputed.csv&quot;</span>)</a>
<a class="sourceLine" id="cb818-3" title="3">Train &lt;-<span class="st"> </span><span class="kw">subset</span>(polling, Year <span class="op">==</span><span class="st"> </span><span class="dv">2004</span> <span class="op">|</span><span class="st"> </span>Year<span class="op">==</span><span class="dv">2008</span>)</a>
<a class="sourceLine" id="cb818-4" title="4">Test &lt;-<span class="st"> </span><span class="kw">subset</span>(polling, Year <span class="op">==</span><span class="st"> </span><span class="dv">2012</span>)</a>
<a class="sourceLine" id="cb818-5" title="5"></a>
<a class="sourceLine" id="cb818-6" title="6">mod2 &lt;-<span class="st"> </span><span class="kw">glm</span>(Republican<span class="op">~</span>SurveyUSA<span class="op">+</span>DiffCount, <span class="dt">data=</span>Train, <span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb818-7" title="7">TestPrediction &lt;-<span class="st"> </span><span class="kw">predict</span>(mod2, <span class="dt">newdata=</span>Test, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb818-8" title="8">TestPredictionBinary &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(TestPrediction <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb818-9" title="9"></a>
<a class="sourceLine" id="cb818-10" title="10">predictionDataFrame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(TestPrediction, TestPredictionBinary, Test<span class="op">$</span>State)</a>
<a class="sourceLine" id="cb818-11" title="11"><span class="kw">summary</span>(predictionDataFrame<span class="op">$</span>TestPredictionBinary)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  0.4889  1.0000  1.0000</code></pre>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb820-1" title="1"><span class="co">#2.2</span></a>
<a class="sourceLine" id="cb820-2" title="2">predictionDataFrame<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">tolower</span>(predictionDataFrame<span class="op">$</span>Test.State)</a>
<a class="sourceLine" id="cb820-3" title="3">predictionMap &lt;-<span class="st"> </span><span class="kw">merge</span>(statesMap, predictionDataFrame, <span class="dt">by =</span> <span class="st">&quot;region&quot;</span>)</a>
<a class="sourceLine" id="cb820-4" title="4">predictionMap &lt;-<span class="st"> </span>predictionMap[<span class="kw">order</span>(predictionMap<span class="op">$</span>order),]<span class="co">#order</span></a>
<a class="sourceLine" id="cb820-5" title="5"></a>
<a class="sourceLine" id="cb820-6" title="6"><span class="co">#2.4</span></a>
<a class="sourceLine" id="cb820-7" title="7"><span class="kw">ggplot</span>(predictionMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> TestPredictionBinary)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb820-8" title="8"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb821-1" title="1"><span class="co">#2.5</span></a>
<a class="sourceLine" id="cb821-2" title="2"><span class="kw">ggplot</span>(predictionMap, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill =</span> TestPredictionBinary))<span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb821-3" title="3"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>, <span class="dt">breaks=</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Democrat&quot;</span>, <span class="st">&quot;Republican&quot;</span>), <span class="dt">name =</span> <span class="st">&quot;Prediction 2012&quot;</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-120-2.png" width="672" /></p>
</div>
<div id="problem-3---understanding-the-predictions" class="section level4">
<h4><span class="header-section-number">8.4.1.3</span> Problem 3 - Understanding the Predictions</h4>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb822-1" title="1"><span class="co">#3.2 What was our predicted probability for the state of Florida?</span></a>
<a class="sourceLine" id="cb822-2" title="2"><span class="kw">tapply</span>(predictionMap<span class="op">$</span>TestPrediction,predictionMap<span class="op">$</span>Test.State, mean)</a></code></pre></div>
<pre><code>##        Alabama         Alaska        Arizona       Arkansas     California 
##             NA             NA   9.739028e-01   9.994949e-01   9.261522e-05 
##       Colorado    Connecticut       Delaware        Florida        Georgia 
##   9.432967e-03   3.431627e-05             NA   9.640395e-01   9.901680e-01 
##         Hawaii          Idaho       Illinois        Indiana           Iowa 
##             NA   9.996372e-01   9.262188e-05   9.992970e-01   6.486672e-02 
##         Kansas       Kentucky      Louisiana          Maine       Maryland 
##   9.506137e-01   9.901659e-01   9.994949e-01   9.382536e-04   2.431748e-06 
##  Massachusetts       Michigan      Minnesota    Mississippi       Missouri 
##   1.236970e-07   1.770169e-05   4.843047e-04   9.325489e-01   9.990219e-01 
...</code></pre>
</div>
</div>
<div id="part-2---visualizing-network-data" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Part 2 - Visualizing Network Data</h3>
<div id="problem-1---summarizing-the-data" class="section level4">
<h4><span class="header-section-number">8.4.2.1</span> Problem 1 - Summarizing the Data</h4>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb824-1" title="1">edges &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/edges.csv&quot;</span>)</a>
<a class="sourceLine" id="cb824-2" title="2">users &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;week7/users.csv&quot;</span>)</a>
<a class="sourceLine" id="cb824-3" title="3"><span class="kw">str</span>(edges)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    146 obs. of  2 variables:
##  $ V1: int  4019 4023 4023 4027 3988 3982 3994 3998 3993 3982 ...
##  $ V2: int  4026 4031 4030 4032 4021 3986 3998 3999 3995 4021 ...</code></pre>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb826-1" title="1"><span class="kw">str</span>(users)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    59 obs. of  4 variables:
##  $ id    : int  3981 3982 3983 3984 3985 3986 3987 3988 3989 3990 ...
##  $ gender: Factor w/ 3 levels &quot;&quot;,&quot;A&quot;,&quot;B&quot;: 2 3 3 3 3 3 2 3 3 2 ...
##  $ school: Factor w/ 3 levels &quot;&quot;,&quot;A&quot;,&quot;AB&quot;: 2 1 1 1 1 2 1 1 2 1 ...
##  $ locale: Factor w/ 3 levels &quot;&quot;,&quot;A&quot;,&quot;B&quot;: 3 3 3 3 3 3 2 3 3 2 ...</code></pre>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb828-1" title="1"><span class="co">#1.2 - Out of all the students who listed a school, what was the most common locale?</span></a>
<a class="sourceLine" id="cb828-2" title="2"><span class="kw">table</span>(users<span class="op">$</span>locale)</a></code></pre></div>
<pre><code>## 
##     A  B 
##  3  6 50</code></pre>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb830-1" title="1"><span class="co">#1.3 </span></a>
<a class="sourceLine" id="cb830-2" title="2"><span class="kw">table</span>(users<span class="op">$</span>gender)</a></code></pre></div>
<pre><code>## 
##     A  B 
##  2 15 42</code></pre>
</div>
<div id="problem-2---creating-a-network" class="section level4">
<h4><span class="header-section-number">8.4.2.2</span> Problem 2 - Creating a network</h4>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb832-1" title="1"><span class="kw">library</span>(igraph)</a>
<a class="sourceLine" id="cb832-2" title="2">g &lt;-<span class="st"> </span><span class="kw">graph.data.frame</span>(edges,<span class="ot">FALSE</span>,users)</a>
<a class="sourceLine" id="cb832-3" title="3"></a>
<a class="sourceLine" id="cb832-4" title="4"><span class="co">#2.2</span></a>
<a class="sourceLine" id="cb832-5" title="5"><span class="kw">plot</span>(g, <span class="dt">vertex.size=</span><span class="dv">5</span>, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb833-1" title="1"><span class="co">#2.3 How many users are friends with 10 or more other Facebook users in this network?</span></a>
<a class="sourceLine" id="cb833-2" title="2"><span class="kw">table</span>(<span class="kw">degree</span>(g) <span class="op">&gt;=</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    50     9</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb835-1" title="1"><span class="kw">V</span>(g)<span class="op">$</span>size &lt;-<span class="st"> </span><span class="kw">degree</span>(g)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span> <span class="co">#Normalize node sie to friends</span></a>
<a class="sourceLine" id="cb835-2" title="2"><span class="kw">plot</span>(g, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-123-2.png" width="672" /></p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb836-1" title="1"><span class="kw">summary</span>(<span class="kw">V</span>(g)<span class="op">$</span>size)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.000   2.500   3.500   4.475   6.000  11.000</code></pre>
</div>
<div id="problem-3---coloring-vertices" class="section level4">
<h4><span class="header-section-number">8.4.2.3</span> Problem 3 - Coloring Vertices</h4>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb838-1" title="1"><span class="kw">V</span>(g)<span class="op">$</span>color &lt;-<span class="st"> &quot;black&quot;</span></a>
<a class="sourceLine" id="cb838-2" title="2"><span class="co">#Color by gender</span></a>
<a class="sourceLine" id="cb838-3" title="3"><span class="kw">V</span>(g)<span class="op">$</span>color[<span class="kw">V</span>(g)<span class="op">$</span>gender <span class="op">==</span><span class="st"> &quot;A&quot;</span>] &lt;-<span class="st"> &quot;red&quot;</span></a>
<a class="sourceLine" id="cb838-4" title="4"><span class="kw">V</span>(g)<span class="op">$</span>color[<span class="kw">V</span>(g)<span class="op">$</span>gender <span class="op">==</span><span class="st"> &quot;B&quot;</span>] &lt;-<span class="st"> &quot;gray&quot;</span></a>
<a class="sourceLine" id="cb838-5" title="5"><span class="kw">plot</span>(g, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb839-1" title="1"><span class="co">#Color by school</span></a>
<a class="sourceLine" id="cb839-2" title="2"><span class="kw">V</span>(g)<span class="op">$</span>color &lt;-<span class="st"> &quot;black&quot;</span></a>
<a class="sourceLine" id="cb839-3" title="3"><span class="kw">V</span>(g)<span class="op">$</span>color[<span class="kw">V</span>(g)<span class="op">$</span>school <span class="op">==</span><span class="st"> &quot;A&quot;</span>] &lt;-<span class="st"> &quot;red&quot;</span></a>
<a class="sourceLine" id="cb839-4" title="4"><span class="kw">V</span>(g)<span class="op">$</span>color[<span class="kw">V</span>(g)<span class="op">$</span>school <span class="op">==</span><span class="st"> &quot;AB&quot;</span>] &lt;-<span class="st"> &quot;blue&quot;</span></a>
<a class="sourceLine" id="cb839-5" title="5"><span class="kw">plot</span>(g, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-124-2.png" width="672" /></p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb840-1" title="1"><span class="co">#Color by locale</span></a>
<a class="sourceLine" id="cb840-2" title="2"><span class="kw">V</span>(g)<span class="op">$</span>color &lt;-<span class="st"> &quot;black&quot;</span></a>
<a class="sourceLine" id="cb840-3" title="3"><span class="kw">V</span>(g)<span class="op">$</span>color[<span class="kw">V</span>(g)<span class="op">$</span>locale <span class="op">==</span><span class="st"> &quot;A&quot;</span>] &lt;-<span class="st"> &quot;red&quot;</span></a>
<a class="sourceLine" id="cb840-4" title="4"><span class="kw">V</span>(g)<span class="op">$</span>color[<span class="kw">V</span>(g)<span class="op">$</span>locale <span class="op">==</span><span class="st"> &quot;B&quot;</span>] &lt;-<span class="st"> &quot;blue&quot;</span></a>
<a class="sourceLine" id="cb840-5" title="5"><span class="kw">plot</span>(g, <span class="dt">vertex.label=</span><span class="ot">NA</span>)</a></code></pre></div>
<p><img src="analytics_edge_files/figure-html/unnamed-chunk-124-3.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="clustering.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-exam.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"download": ["pdf", "epub"]
}
});
});
</script>

</body>

</html>
